# æ‰‹å†™æ•°å­—æ£€æµ‹æ£€æµ‹ç³»ç»Ÿæºç åˆ†äº«
 # [ä¸€æ¡é¾™æ•™å­¦YOLOV8æ ‡æ³¨å¥½çš„æ•°æ®é›†ä¸€é”®è®­ç»ƒ_70+å…¨å¥—æ”¹è¿›åˆ›æ–°ç‚¹å‘åˆŠ_Webå‰ç«¯å±•ç¤º]

### 1.ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

é¡¹ç›®å‚è€ƒ[AAAI Association for the Advancement of Artificial Intelligence](https://gitee.com/qunmasj/projects)

é¡¹ç›®æ¥æº[AACV Association for the Advancement of Computer Vision](https://github.com/qunshansj/good)

ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰

éšç€äººå·¥æ™ºèƒ½æŠ€æœ¯çš„è¿…çŒ›å‘å±•ï¼Œè®¡ç®—æœºè§†è§‰é¢†åŸŸçš„ç ”ç©¶æ—¥ç›Šå—åˆ°å…³æ³¨ã€‚æ‰‹å†™æ•°å­—è¯†åˆ«ä½œä¸ºè®¡ç®—æœºè§†è§‰ä¸­çš„ä¸€ä¸ªé‡è¦åº”ç”¨ï¼Œå¹¿æ³›åº”ç”¨äºé“¶è¡Œæ”¯ç¥¨å¤„ç†ã€é‚®æ”¿ç¼–ç è¯†åˆ«ã€è‡ªåŠ¨åŒ–è¡¨å•å¤„ç†ç­‰å¤šä¸ªé¢†åŸŸã€‚ä¼ ç»Ÿçš„æ‰‹å†™æ•°å­—è¯†åˆ«æ–¹æ³•å¤šä¾èµ–äºç‰¹å¾æå–å’Œåˆ†ç±»å™¨è®¾è®¡ï¼Œç„¶è€Œï¼Œè¿™äº›æ–¹æ³•åœ¨å¤„ç†å¤æ‚èƒŒæ™¯ã€ä¸åŒä¹¦å†™é£æ ¼å’Œæ¨¡ç³Šå›¾åƒæ—¶ï¼Œå¾€å¾€è¡¨ç°ä¸ä½³ã€‚è¿‘å¹´æ¥ï¼Œæ·±åº¦å­¦ä¹ ç‰¹åˆ«æ˜¯å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰çš„å…´èµ·ï¼Œä¸ºæ‰‹å†™æ•°å­—è¯†åˆ«æä¾›äº†æ–°çš„è§£å†³æ–¹æ¡ˆï¼Œæ˜¾è‘—æé«˜äº†è¯†åˆ«çš„å‡†ç¡®æ€§å’Œé²æ£’æ€§ã€‚

åœ¨ä¼—å¤šæ·±åº¦å­¦ä¹ æ¨¡å‹ä¸­ï¼ŒYOLOï¼ˆYou Only Look Onceï¼‰ç³»åˆ—æ¨¡å‹å› å…¶å®æ—¶æ€§å’Œé«˜æ•ˆæ€§è€Œå¤‡å—é’çã€‚YOLOv8ä½œä¸ºè¯¥ç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè¿›ä¸€æ­¥ä¼˜åŒ–äº†æ¨¡å‹ç»“æ„å’Œè®­ç»ƒç­–ç•¥ï¼Œæå‡äº†ç›®æ ‡æ£€æµ‹çš„ç²¾åº¦å’Œé€Ÿåº¦ã€‚ç„¶è€Œï¼Œç°æœ‰çš„YOLOv8æ¨¡å‹åœ¨æ‰‹å†™æ•°å­—æ£€æµ‹ä»»åŠ¡ä¸­çš„åº”ç”¨ä»ç„¶å­˜åœ¨ä¸€å®šçš„å±€é™æ€§ï¼Œä¸»è¦ä½“ç°åœ¨å¯¹æ‰‹å†™æ•°å­—çš„å¤šæ ·æ€§å’Œå¤æ‚æ€§çš„é€‚åº”èƒ½åŠ›ä¸è¶³ã€‚å› æ­¤ï¼ŒåŸºäºæ”¹è¿›YOLOv8çš„æ‰‹å†™æ•°å­—æ£€æµ‹ç³»ç»Ÿçš„ç ”ç©¶æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚

æœ¬ç ”ç©¶å°†ä»¥Hashiwokakeroæ•°æ®é›†ä¸ºåŸºç¡€ï¼Œè¯¥æ•°æ®é›†åŒ…å«9900å¼ æ‰‹å†™æ•°å­—å›¾åƒï¼Œæ¶µç›–äº†ä»1åˆ°8çš„å…«ä¸ªç±»åˆ«ã€‚è¿™ä¸€æ•°æ®é›†çš„ä¸°å¯Œæ€§ä¸ºæ¨¡å‹çš„è®­ç»ƒå’Œè¯„ä¼°æä¾›äº†è‰¯å¥½çš„åŸºç¡€ã€‚é€šè¿‡å¯¹è¯¥æ•°æ®é›†çš„æ·±å…¥åˆ†æï¼Œå¯ä»¥å‘ç°æ‰‹å†™æ•°å­—åœ¨ä¹¦å†™é£æ ¼ã€ç¬”ç”»ç²—ç»†ã€èƒŒæ™¯å¤æ‚åº¦ç­‰æ–¹é¢çš„å¤šæ ·æ€§ï¼Œè¿™ä¸ºæ¨¡å‹çš„è®¾è®¡æå‡ºäº†æ›´é«˜çš„è¦æ±‚ã€‚ä¸ºäº†æé«˜YOLOv8åœ¨æ‰‹å†™æ•°å­—æ£€æµ‹ä¸­çš„è¡¨ç°ï¼Œæœ¬ç ”ç©¶å°†é’ˆå¯¹æ•°æ®é›†çš„ç‰¹ç‚¹ï¼Œå¯¹YOLOv8è¿›è¡Œä¸€ç³»åˆ—æ”¹è¿›ï¼ŒåŒ…æ‹¬æ•°æ®å¢å¼ºã€æ¨¡å‹ç»“æ„ä¼˜åŒ–å’ŒæŸå¤±å‡½æ•°è°ƒæ•´ç­‰ã€‚è¿™äº›æ”¹è¿›æ—¨åœ¨æå‡æ¨¡å‹å¯¹ä¸åŒä¹¦å†™é£æ ¼å’Œå¤æ‚èƒŒæ™¯çš„é€‚åº”èƒ½åŠ›ï¼Œä»è€Œæé«˜æ‰‹å†™æ•°å­—çš„æ£€æµ‹ç²¾åº¦ã€‚

æœ¬ç ”ç©¶çš„æ„ä¹‰ä¸ä»…åœ¨äºæå‡æ‰‹å†™æ•°å­—æ£€æµ‹çš„æŠ€æœ¯æ°´å¹³ï¼Œæ›´åœ¨äºæ¨åŠ¨æ·±åº¦å­¦ä¹ åœ¨å®é™…åº”ç”¨ä¸­çš„è½åœ°ã€‚é€šè¿‡æ„å»ºä¸€ä¸ªé«˜æ•ˆã€å‡†ç¡®çš„æ‰‹å†™æ•°å­—æ£€æµ‹ç³»ç»Ÿï¼Œå¯ä»¥ä¸ºé‡‘èã€é‚®æ”¿ç­‰è¡Œä¸šçš„è‡ªåŠ¨åŒ–å¤„ç†æä¾›æŠ€æœ¯æ”¯æŒï¼Œé™ä½äººå·¥æˆæœ¬ï¼Œæé«˜å·¥ä½œæ•ˆç‡ã€‚æ­¤å¤–ï¼Œæ”¹è¿›YOLOv8çš„ç ”ç©¶æˆæœä¹Ÿå¯ä»¥ä¸ºå…¶ä»–é¢†åŸŸçš„ç›®æ ‡æ£€æµ‹ä»»åŠ¡æä¾›å€Ÿé‰´ï¼Œæ¨åŠ¨è®¡ç®—æœºè§†è§‰æŠ€æœ¯çš„è¿›ä¸€æ­¥å‘å±•ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼ŒåŸºäºæ”¹è¿›YOLOv8çš„æ‰‹å†™æ•°å­—æ£€æµ‹ç³»ç»Ÿçš„ç ”ç©¶ï¼Œä¸ä»…å…·æœ‰é‡è¦çš„ç†è®ºä»·å€¼ï¼Œè¿˜æœ‰ç€å¹¿æ³›çš„å®é™…åº”ç”¨å‰æ™¯ã€‚é€šè¿‡æ·±å…¥æ¢ç´¢æ‰‹å†™æ•°å­—è¯†åˆ«ä¸­çš„å…³é”®æŠ€æœ¯é—®é¢˜ï¼Œæœ¬ç ”ç©¶å°†ä¸ºæ¨åŠ¨æ™ºèƒ½åŒ–æ—¶ä»£çš„åˆ°æ¥è´¡çŒ®ä¸€ä»½åŠ›é‡ã€‚

### 2.å›¾ç‰‡æ¼”ç¤º

![1.png](1.png)

![2.png](2.png)

![3.png](3.png)

##### æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ2.å›¾ç‰‡æ¼”ç¤ºâ€å’Œâ€œ3.è§†é¢‘æ¼”ç¤ºâ€å±•ç¤ºçš„ç³»ç»Ÿå›¾ç‰‡æˆ–è€…è§†é¢‘å¯èƒ½ä¸ºè€ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬åœ¨è€ç‰ˆæœ¬çš„åŸºç¡€ä¸Šå‡çº§å¦‚ä¸‹ï¼šï¼ˆå®é™…æ•ˆæœä»¥å‡çº§çš„æ–°ç‰ˆæœ¬ä¸ºå‡†ï¼‰

  ï¼ˆ1ï¼‰é€‚é…äº†YOLOV8çš„â€œç›®æ ‡æ£€æµ‹â€æ¨¡å‹å’Œâ€œå®ä¾‹åˆ†å‰²â€æ¨¡å‹ï¼Œé€šè¿‡åŠ è½½ç›¸åº”çš„æƒé‡ï¼ˆ.ptï¼‰æ–‡ä»¶å³å¯è‡ªé€‚åº”åŠ è½½æ¨¡å‹ã€‚

  ï¼ˆ2ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«æ¨¡å¼ã€‚

  ï¼ˆ3ï¼‰æ”¯æŒâ€œå›¾ç‰‡è¯†åˆ«â€ã€â€œè§†é¢‘è¯†åˆ«â€ã€â€œæ‘„åƒå¤´å®æ—¶è¯†åˆ«â€ä¸‰ç§è¯†åˆ«ç»“æœä¿å­˜å¯¼å‡ºï¼Œè§£å†³æ‰‹åŠ¨å¯¼å‡ºï¼ˆå®¹æ˜“å¡é¡¿å‡ºç°çˆ†å†…å­˜ï¼‰å­˜åœ¨çš„é—®é¢˜ï¼Œè¯†åˆ«å®Œè‡ªåŠ¨ä¿å­˜ç»“æœå¹¶å¯¼å‡ºåˆ°tempDirä¸­ã€‚

  ï¼ˆ4ï¼‰æ”¯æŒWebå‰ç«¯ç³»ç»Ÿä¸­çš„æ ‡é¢˜ã€èƒŒæ™¯å›¾ç­‰è‡ªå®šä¹‰ä¿®æ”¹ï¼Œåé¢æä¾›ä¿®æ”¹æ•™ç¨‹ã€‚

  å¦å¤–æœ¬é¡¹ç›®æä¾›è®­ç»ƒçš„æ•°æ®é›†å’Œè®­ç»ƒæ•™ç¨‹,æš‚ä¸æä¾›æƒé‡æ–‡ä»¶ï¼ˆbest.ptï¼‰,éœ€è¦æ‚¨æŒ‰ç…§æ•™ç¨‹è¿›è¡Œè®­ç»ƒåå®ç°å›¾ç‰‡æ¼”ç¤ºå’ŒWebå‰ç«¯ç•Œé¢æ¼”ç¤ºçš„æ•ˆæœã€‚

### 3.è§†é¢‘æ¼”ç¤º

[3.1 è§†é¢‘æ¼”ç¤º](https://www.bilibili.com/video/BV1bpHYeXEw1/?vd_source=ff015de2d29cbe2a9cdbfa7064407a08)

### 4.æ•°æ®é›†ä¿¡æ¯å±•ç¤º

æ•°æ®é›†ä¿¡æ¯å±•ç¤º

åœ¨æœ¬ç ”ç©¶ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†åä¸ºâ€œHashiwokakeroâ€çš„æ•°æ®é›†ï¼Œä»¥è®­ç»ƒå’Œæ”¹è¿›YOLOv8æ‰‹å†™æ•°å­—æ£€æµ‹ç³»ç»Ÿã€‚è¯¥æ•°æ®é›†ä¸“æ³¨äºæ‰‹å†™æ•°å­—çš„è¯†åˆ«ï¼ŒåŒ…å«äº†ä¸°å¯Œçš„æ ·æœ¬å’Œå¤šæ ·åŒ–çš„æ‰‹å†™é£æ ¼ï¼Œæ—¨åœ¨æé«˜æ¨¡å‹åœ¨å®é™…åº”ç”¨ä¸­çš„å‡†ç¡®æ€§å’Œé²æ£’æ€§ã€‚æ•°æ®é›†çš„ç±»åˆ«æ•°é‡ä¸º8ï¼Œå…·ä½“åŒ…æ‹¬æ•°å­—1è‡³8ï¼Œè¿™äº›ç±»åˆ«æ¶µç›–äº†åŸºæœ¬çš„æ‰‹å†™æ•°å­—å½¢å¼ï¼Œä¸ºæ¨¡å‹æä¾›äº†å¹¿æ³›çš„å­¦ä¹ åŸºç¡€ã€‚

â€œHashiwokakeroâ€æ•°æ®é›†çš„è®¾è®¡åˆè¡·æ˜¯ä¸ºäº†æ”¯æŒæ‰‹å†™æ•°å­—çš„è‡ªåŠ¨è¯†åˆ«ï¼Œå°¤å…¶æ˜¯åœ¨å¤æ‚çš„æ‰‹å†™ç¯å¢ƒä¸­ã€‚æ¯ä¸ªç±»åˆ«çš„æ ·æœ¬å‡ç»è¿‡ç²¾å¿ƒæŒ‘é€‰ï¼Œç¡®ä¿å…¶ä»£è¡¨æ€§å’Œå¤šæ ·æ€§ã€‚æ•°å­—çš„ä¹¦å†™é£æ ¼å„å¼‚ï¼Œæ—¢åŒ…æ‹¬å¸¸è§çš„å°åˆ·ä½“ï¼Œä¹Ÿæ¶µç›–äº†å„ç§ä¹¦å†™ä¹ æƒ¯ä¸‹çš„æ‰‹å†™ä½“ã€‚è¿™ç§å¤šæ ·æ€§ä½¿å¾—æ•°æ®é›†èƒ½å¤Ÿæœ‰æ•ˆåœ°æ¨¡æ‹Ÿç°å®ä¸–ç•Œä¸­æ‰‹å†™æ•°å­—çš„å¤æ‚æ€§ï¼Œè¿›è€Œæå‡YOLOv8æ¨¡å‹åœ¨ä¸åŒåœºæ™¯ä¸‹çš„è¯†åˆ«èƒ½åŠ›ã€‚

åœ¨æ•°æ®é›†çš„æ„å»ºè¿‡ç¨‹ä¸­ï¼Œç ”ç©¶è€…ä»¬ä¸ä»…å…³æ³¨æ ·æœ¬çš„æ•°é‡ï¼Œæ›´æ³¨é‡æ ·æœ¬çš„è´¨é‡ã€‚æ¯ä¸ªæ•°å­—ç±»åˆ«çš„æ ·æœ¬å‡ç»è¿‡ä¸¥æ ¼çš„æ ‡æ³¨ï¼Œç¡®ä¿æ¯ä¸ªå›¾åƒéƒ½èƒ½å‡†ç¡®åæ˜ å…¶å¯¹åº”çš„æ•°å­—ã€‚è¿™ç§é«˜è´¨é‡çš„æ ‡æ³¨ä¸ºYOLOv8çš„è®­ç»ƒæä¾›äº†åšå®çš„åŸºç¡€ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿåœ¨å­¦ä¹ è¿‡ç¨‹ä¸­æ›´å¥½åœ°ç†è§£æ•°å­—çš„ç‰¹å¾å’Œå˜åŒ–ã€‚æ­¤å¤–ï¼Œæ•°æ®é›†è¿˜åŒ…å«äº†å¤šç§å…‰ç…§æ¡ä»¶å’ŒèƒŒæ™¯ç¯å¢ƒä¸‹çš„æ‰‹å†™æ•°å­—å›¾åƒï¼Œè¿›ä¸€æ­¥å¢å¼ºäº†æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚

ä¸ºäº†æé«˜æ¨¡å‹çš„è®­ç»ƒæ•ˆç‡å’Œæ•ˆæœï¼Œæ•°æ®é›†è¿˜é‡‡ç”¨äº†æ•°æ®å¢å¼ºæŠ€æœ¯ã€‚è¿™äº›æŠ€æœ¯åŒ…æ‹¬æ—‹è½¬ã€ç¼©æ”¾ã€å¹³ç§»ã€æ·»åŠ å™ªå£°ç­‰ï¼Œæ—¨åœ¨æ¨¡æ‹Ÿå„ç§å¯èƒ½çš„ä¹¦å†™æƒ…å†µã€‚é€šè¿‡è¿™äº›å¢å¼ºæ‰‹æ®µï¼Œæ¨¡å‹èƒ½å¤Ÿåœ¨æ›´å¹¿æ³›çš„åœºæ™¯ä¸­è¿›è¡Œè®­ç»ƒï¼Œä»è€Œæé«˜å…¶åœ¨çœŸå®åº”ç”¨ä¸­çš„è¡¨ç°ã€‚è¿™ç§ç­–ç•¥ä¸ä»…æé«˜äº†æ¨¡å‹çš„å‡†ç¡®æ€§ï¼Œä¹Ÿé™ä½äº†è¿‡æ‹Ÿåˆçš„é£é™©ï¼Œä½¿å¾—YOLOv8åœ¨é¢å¯¹æ–°æ ·æœ¬æ—¶èƒ½å¤Ÿä¿æŒè¾ƒé«˜çš„è¯†åˆ«ç‡ã€‚

åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†â€œHashiwokakeroâ€æ•°æ®é›†ä¸YOLOv8æ¨¡å‹ç›¸ç»“åˆï¼Œå……åˆ†åˆ©ç”¨YOLOv8åœ¨ç›®æ ‡æ£€æµ‹æ–¹é¢çš„ä¼˜åŠ¿ã€‚é€šè¿‡ç²¾ç»†çš„è°ƒå‚å’Œä¼˜åŒ–ï¼Œæˆ‘ä»¬æœŸæœ›èƒ½å¤Ÿå®ç°å¯¹æ‰‹å†™æ•°å­—çš„é«˜æ•ˆæ£€æµ‹ä¸è¯†åˆ«ã€‚æ¨¡å‹çš„è¾“å‡ºä¸ä»…åŒ…æ‹¬æ•°å­—çš„ç±»åˆ«ï¼Œè¿˜å°†æä¾›æ¯ä¸ªæ•°å­—åœ¨å›¾åƒä¸­çš„ä½ç½®ï¼Œè¿™å¯¹äºåç»­çš„åº”ç”¨åœºæ™¯ï¼Œå¦‚è‡ªåŠ¨è¯„åˆ†ã€æ–‡æ¡£å¤„ç†ç­‰ï¼Œå…·æœ‰é‡è¦æ„ä¹‰ã€‚

æ€»ä¹‹ï¼Œâ€œHashiwokakeroâ€æ•°æ®é›†ä¸ºæœ¬ç ”ç©¶æä¾›äº†ä¸€ä¸ªåšå®çš„åŸºç¡€ï¼Œæ”¯æŒæˆ‘ä»¬åœ¨æ‰‹å†™æ•°å­—æ£€æµ‹é¢†åŸŸçš„æ¢ç´¢ä¸åˆ›æ–°ã€‚é€šè¿‡å¯¹è¯¥æ•°æ®é›†çš„æ·±å…¥åˆ†æä¸åº”ç”¨ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿæ¨åŠ¨YOLOv8æ¨¡å‹åœ¨æ‰‹å†™æ•°å­—è¯†åˆ«ä¸­çš„åº”ç”¨ï¼Œä¸ºç›¸å…³é¢†åŸŸçš„ç ”ç©¶ä¸å®è·µæä¾›æœ‰åŠ›çš„æ”¯æŒã€‚éšç€ç ”ç©¶çš„æ·±å…¥ï¼Œæˆ‘ä»¬æœŸå¾…è¯¥æ¨¡å‹èƒ½å¤Ÿåœ¨å®é™…åº”ç”¨ä¸­å±•ç°å‡ºæ›´å¼ºçš„æ€§èƒ½ï¼Œä¸ºæ‰‹å†™æ•°å­—çš„è‡ªåŠ¨è¯†åˆ«æä¾›æ›´ä¸ºç²¾å‡†å’Œé«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚

![4.png](4.png)

![5.png](5.png)

![6.png](6.png)

![7.png](7.png)

![8.png](8.png)

### 5.å…¨å¥—é¡¹ç›®ç¯å¢ƒéƒ¨ç½²è§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰

[5.1 ç¯å¢ƒéƒ¨ç½²æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404473917358506534?logTag=c807d0cbc21c0ef59de5)




[5.2 å®‰è£…Pythonè™šæ‹Ÿç¯å¢ƒåˆ›å»ºå’Œä¾èµ–åº“å®‰è£…è§†é¢‘æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404474678003106304?logTag=1f1041108cd1f708b01a)

### 6.æ‰‹æŠŠæ‰‹YOLOV8è®­ç»ƒè§†é¢‘æ•™ç¨‹ï¼ˆé›¶åŸºç¡€å°ç™½æœ‰æ‰‹å°±èƒ½å­¦ä¼šï¼‰

[6.1 ç¯å¢ƒéƒ¨ç½²æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404477157818401292?logTag=d31a2dfd1983c9668658)

### 7.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹ä»£ç åŠ è½½è°ƒå‚è§†é¢‘æ•™ç¨‹ï¼ˆä¸€é”®åŠ è½½å†™å¥½çš„æ”¹è¿›æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼‰

[7.1 ç¯å¢ƒéƒ¨ç½²æ•™ç¨‹é“¾æ¥ï¼ˆé›¶åŸºç¡€æ‰‹æŠŠæ‰‹æ•™å­¦ï¼‰](https://www.ixigua.com/7404478314661806627?logTag=29066f8288e3f4eea3a4)

### 8.70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£ï¼ˆéç§‘ç­ä¹Ÿå¯ä»¥è½»æ¾å†™åˆŠå‘åˆŠï¼ŒV10ç‰ˆæœ¬æ­£åœ¨ç§‘ç ”å¾…æ›´æ–°ï¼‰

ç”±äºç¯‡å¹…é™åˆ¶ï¼Œæ¯ä¸ªåˆ›æ–°ç‚¹çš„å…·ä½“åŸç†è®²è§£å°±ä¸ä¸€ä¸€å±•å¼€ï¼Œå…·ä½“è§ä¸‹åˆ—ç½‘å€ä¸­çš„åˆ›æ–°ç‚¹å¯¹åº”å­é¡¹ç›®çš„æŠ€æœ¯åŸç†åšå®¢ç½‘å€ã€Blogã€‘ï¼š

![9.png](9.png)

[8.1 70+ç§å…¨å¥—YOLOV8åˆ›æ–°ç‚¹åŸç†è®²è§£é“¾æ¥](https://gitee.com/qunmasj/good)

### 9.ç³»ç»ŸåŠŸèƒ½å±•ç¤ºï¼ˆæ£€æµ‹å¯¹è±¡ä¸ºä¸¾ä¾‹ï¼Œå®é™…å†…å®¹ä»¥æœ¬é¡¹ç›®æ•°æ®é›†ä¸ºå‡†ï¼‰

å›¾9.1.ç³»ç»Ÿæ”¯æŒæ£€æµ‹ç»“æœè¡¨æ ¼æ˜¾ç¤º

  å›¾9.2.ç³»ç»Ÿæ”¯æŒç½®ä¿¡åº¦å’ŒIOUé˜ˆå€¼æ‰‹åŠ¨è°ƒèŠ‚

  å›¾9.3.ç³»ç»Ÿæ”¯æŒè‡ªå®šä¹‰åŠ è½½æƒé‡æ–‡ä»¶best.pt(éœ€è¦ä½ é€šè¿‡æ­¥éª¤5ä¸­è®­ç»ƒè·å¾—)

  å›¾9.4.ç³»ç»Ÿæ”¯æŒæ‘„åƒå¤´å®æ—¶è¯†åˆ«

  å›¾9.5.ç³»ç»Ÿæ”¯æŒå›¾ç‰‡è¯†åˆ«

  å›¾9.6.ç³»ç»Ÿæ”¯æŒè§†é¢‘è¯†åˆ«

  å›¾9.7.ç³»ç»Ÿæ”¯æŒè¯†åˆ«ç»“æœæ–‡ä»¶è‡ªåŠ¨ä¿å­˜

  å›¾9.8.ç³»ç»Ÿæ”¯æŒExcelå¯¼å‡ºæ£€æµ‹ç»“æœæ•°æ®

![10.png](10.png)

![11.png](11.png)

![12.png](12.png)

![13.png](13.png)

![14.png](14.png)

![15.png](15.png)

![16.png](16.png)

![17.png](17.png)

### 10.åŸå§‹YOLOV8ç®—æ³•åŸç†

åŸå§‹YOLOv8ç®—æ³•åŸç†

YOLOv8ç®—æ³•ä½œä¸ºç›®æ ‡æ£€æµ‹é¢†åŸŸçš„æœ€æ–°è¿›å±•ï¼Œæ‰¿è½½ç€YOLOç³»åˆ—æ¨¡å‹åœ¨ç²¾åº¦å’Œé€Ÿåº¦ä¸Šçš„æŒç»­ä¼˜åŒ–ã€‚å…¶è®¾è®¡ç†å¿µæ˜¯é€šè¿‡é«˜æ•ˆçš„ç½‘ç»œç»“æ„å’Œåˆ›æ–°çš„ç‰¹å¾æå–æ–¹æ³•ï¼Œå®ç°å¯¹å›¾åƒä¸­ç›®æ ‡çš„å¿«é€Ÿè€Œå‡†ç¡®çš„æ£€æµ‹ã€‚YOLOv8çš„æ¶æ„ä¸»è¦ç”±è¾“å…¥å±‚ã€ä¸»å¹²ç½‘ç»œã€é¢ˆéƒ¨ç½‘ç»œå’Œå¤´éƒ¨ç½‘ç»œå››ä¸ªæ ¸å¿ƒç»„ä»¶æ„æˆï¼Œæ¯ä¸ªéƒ¨åˆ†éƒ½åœ¨å‰ä¸€ç‰ˆæœ¬çš„åŸºç¡€ä¸Šè¿›è¡Œäº†æ˜¾è‘—çš„æ”¹è¿›å’Œä¼˜åŒ–ã€‚

åœ¨è¾“å…¥å±‚ï¼ŒYOLOv8é¦–å…ˆå¯¹è¾“å…¥å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼Œä»¥æ»¡è¶³ç‰¹å®šçš„è¾“å…¥å°ºå¯¸è¦æ±‚ã€‚è¿™ä¸€è¿‡ç¨‹ä¸ä»…åŒ…æ‹¬ç®€å•çš„ç¼©æ”¾ï¼Œè¿˜æ¶‰åŠåˆ°Mosaicå¢å¼ºæŠ€æœ¯ï¼Œè¿™ç§æŠ€æœ¯é€šè¿‡å°†å¤šå¼ å›¾åƒæ‹¼æ¥åœ¨ä¸€èµ·ï¼Œç”Ÿæˆæ–°çš„è®­ç»ƒæ ·æœ¬ï¼Œä»è€Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›å’Œé²æ£’æ€§ã€‚æ­¤å¤–ï¼ŒYOLOv8è¿˜å¼•å…¥äº†ç„ç‚¹è®¡ç®—ï¼Œä»¥ç¡®ä¿åœ¨ä¸åŒåœºæ™¯ä¸‹ï¼Œæ¨¡å‹èƒ½å¤Ÿæ›´å¥½åœ°æ•æ‰åˆ°ç›®æ ‡çš„ä½ç½®å’Œç‰¹å¾ã€‚

ä¸»å¹²ç½‘ç»œæ˜¯YOLOv8çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œè´Ÿè´£ä»è¾“å…¥å›¾åƒä¸­æå–ç‰¹å¾ã€‚ä¸ä¹‹å‰çš„YOLOç‰ˆæœ¬ä¸åŒï¼ŒYOLOv8é‡‡ç”¨äº†C2fæ¨¡å—æ›¿ä»£äº†ä¼ ç»Ÿçš„C3æ¨¡å—ã€‚C2fæ¨¡å—é€šè¿‡æ·±åº¦å·ç§¯å’Œæ‰¹å½’ä¸€åŒ–çš„ç»“åˆï¼Œèƒ½å¤Ÿæœ‰æ•ˆåœ°æå–å¤šå±‚æ¬¡çš„ç‰¹å¾ä¿¡æ¯ã€‚æ¯ä¸ªå·ç§¯å±‚åéƒ½ä½¿ç”¨SiLUæ¿€æ´»å‡½æ•°ï¼Œä»¥å¢å¼ºéçº¿æ€§ç‰¹å¾çš„è¡¨è¾¾èƒ½åŠ›ã€‚C2fæ¨¡å—çš„è®¾è®¡çµæ„Ÿæ¥æºäºYOLOv7ä¸­çš„E-ELANç»“æ„ï¼Œé€šè¿‡è·¨å±‚åˆ†æ”¯è¿æ¥ï¼Œå¢å¼ºäº†æ¨¡å‹çš„æ¢¯åº¦æµåŠ¨ï¼Œä»è€Œåœ¨ç‰¹å¾æå–è¿‡ç¨‹ä¸­å‡å°‘äº†ä¿¡æ¯çš„æŸå¤±ã€‚ä¸»å¹²ç½‘ç»œçš„æœ€åï¼ŒSPPFlæ¨¡å—é€šè¿‡ä¸‰ä¸ªæœ€å¤§æ± åŒ–å±‚å¯¹å¤šå°ºåº¦ç‰¹å¾è¿›è¡Œå¤„ç†ï¼Œè¿›ä¸€æ­¥æå‡äº†ç½‘ç»œçš„ç‰¹å¾æŠ½è±¡èƒ½åŠ›ï¼Œä½¿å¾—æ¨¡å‹åœ¨é¢å¯¹ä¸åŒå°ºå¯¸çš„ç›®æ ‡æ—¶ï¼Œèƒ½å¤Ÿä¿æŒè‰¯å¥½çš„æ£€æµ‹æ€§èƒ½ã€‚

é¢ˆéƒ¨ç½‘ç»œçš„è®¾è®¡åŒæ ·è‡³å…³é‡è¦ï¼Œå®ƒè´Ÿè´£å°†æ¥è‡ªä¸»å¹²ç½‘ç»œçš„ç‰¹å¾è¿›è¡Œèåˆã€‚YOLOv8é‡‡ç”¨äº†FPNSï¼ˆç‰¹å¾é‡‘å­—å¡”ç½‘ç»œï¼‰å’ŒPANï¼ˆè·¯å¾„èšåˆç½‘ç»œï¼‰çš„ç»“åˆï¼Œè¿™ç§åŒå¡”ç»“æ„æœ‰æ•ˆåœ°ä¿ƒè¿›äº†ä¸åŒå°ºåº¦ç‰¹å¾å›¾çš„ä¿¡æ¯ä¼ é€’ã€‚FPNSä¸“æ³¨äºé«˜å±‚è¯­ä¹‰ç‰¹å¾çš„æå–ï¼Œè€ŒPANåˆ™å¢å¼ºäº†ä½å±‚ç»†èŠ‚ä¿¡æ¯çš„ä¿ç•™ï¼ŒäºŒè€…çš„ç»“åˆä½¿å¾—YOLOv8åœ¨å¤„ç†å¤æ‚åœºæ™¯æ—¶ï¼Œèƒ½å¤Ÿæ›´å¥½åœ°æ•æ‰åˆ°ç›®æ ‡çš„ç»†èŠ‚ä¸è¯­ä¹‰ä¿¡æ¯ã€‚è¿™ç§ç‰¹å¾èåˆçš„ç­–ç•¥ï¼Œä¸ä»…æé«˜äº†æ¨¡å‹å¯¹å°ç›®æ ‡çš„æ£€æµ‹èƒ½åŠ›ï¼Œä¹Ÿå¢å¼ºäº†å…¶åœ¨å¤æ‚èƒŒæ™¯ä¸‹çš„é²æ£’æ€§ã€‚

åœ¨å¤´éƒ¨ç½‘ç»œéƒ¨åˆ†ï¼ŒYOLOv8é‡‡ç”¨äº†è§£è€¦çš„æ£€æµ‹å¤´è®¾è®¡ã€‚è¿™ä¸€åˆ›æ–°ä½¿å¾—å›å½’å’Œåˆ†ç±»çš„æŸå¤±è®¡ç®—åœ¨ä¸¤ä¸ªå¹¶è¡Œçš„å·ç§¯åˆ†æ”¯ä¸­è¿›è¡Œï¼Œä»è€ŒåŠ é€Ÿäº†æ¨¡å‹çš„æ”¶æ•›é€Ÿåº¦ã€‚é€šè¿‡è¿™ç§è§£è€¦è®¾è®¡ï¼ŒYOLOv8èƒ½å¤Ÿåœ¨ä¿æŒé«˜ç²¾åº¦çš„åŒæ—¶ï¼Œæ˜¾è‘—æé«˜æ£€æµ‹é€Ÿåº¦ï¼Œæ»¡è¶³å®æ—¶åº”ç”¨çš„éœ€æ±‚ã€‚æ­¤å¤–ï¼ŒYOLOv8åœ¨æ£€æµ‹å¤´çš„è®¾è®¡ä¸Šè¿˜å¼•å…¥äº†æ— é”šç›®æ ‡æ£€æµ‹çš„ç†å¿µï¼Œè¿›ä¸€æ­¥ç®€åŒ–äº†æ¨¡å‹çš„å¤æ‚æ€§ï¼Œä½¿å¾—ç›®æ ‡æ£€æµ‹è¿‡ç¨‹æ›´åŠ é«˜æ•ˆã€‚

å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒYOLOv8nä½œä¸ºYOLOv8çš„è½»é‡åŒ–ç‰ˆæœ¬ï¼Œä¸“æ³¨äºåœ¨ä¿è¯æ£€æµ‹æ€§èƒ½çš„åŒæ—¶ï¼Œå‡å°‘æ¨¡å‹çš„è®¡ç®—é‡å’Œå‚æ•°é‡ã€‚é€šè¿‡åœ¨ä¸»å¹²ç‰¹å¾æå–ç½‘ç»œä¸­ä½¿ç”¨æ›´è½»é‡åŒ–çš„C2Fæ¨¡å—ï¼ŒYOLOv8nèƒ½å¤Ÿåœ¨è¾ƒä½çš„è®¡ç®—èµ„æºä¸‹ï¼Œä¾ç„¶å®ç°å‡ºè‰²çš„ç›®æ ‡æ£€æµ‹æ•ˆæœã€‚ç‰¹å¾èåˆå±‚çš„è®¾è®¡åŒæ ·ç»è¿‡ä¼˜åŒ–ï¼Œé‡‡ç”¨BiFPNç½‘ç»œæ¥æé«˜ä¸åŒå°ºåº¦ç‰¹å¾ä¿¡æ¯çš„æå–é€Ÿåº¦ï¼Œç¡®ä¿åœ¨è½»é‡åŒ–çš„åŒæ—¶ï¼Œä¸æŸå¤±æ¨¡å‹çš„æ€§èƒ½ã€‚

æ€»çš„æ¥è¯´ï¼ŒYOLOv8ç®—æ³•é€šè¿‡å¯¹ç½‘ç»œç»“æ„çš„æ·±åº¦ä¼˜åŒ–å’Œåˆ›æ–°è®¾è®¡ï¼Œå±•ç°äº†åœ¨ç›®æ ‡æ£€æµ‹é¢†åŸŸçš„å¼ºå¤§èƒ½åŠ›ã€‚å…¶åœ¨ç‰¹å¾æå–ã€ç‰¹å¾èåˆå’Œæ£€æµ‹å¤´è®¾è®¡ä¸Šçš„è¯¸å¤šæ”¹è¿›ï¼Œä½¿å¾—YOLOv8ä¸ä»…åœ¨ç²¾åº¦ä¸Šå–å¾—äº†æ˜¾è‘—æå‡ï¼ŒåŒæ—¶åœ¨é€Ÿåº¦å’Œè®¡ç®—æ•ˆç‡ä¸Šä¹Ÿè¡¨ç°å‡ºè‰²ã€‚è¿™äº›è¿›æ­¥ä½¿å¾—YOLOv8åœ¨å®é™…åº”ç”¨ä¸­ï¼Œèƒ½å¤Ÿæ»¡è¶³å„ç§å¤æ‚åœºæ™¯ä¸‹çš„ç›®æ ‡æ£€æµ‹éœ€æ±‚ï¼Œè¿›ä¸€æ­¥æ¨åŠ¨äº†è®¡ç®—æœºè§†è§‰æŠ€æœ¯çš„å‘å±•ã€‚éšç€YOLOv8çš„æ¨å¹¿å’Œåº”ç”¨ï¼Œæœªæ¥çš„ç›®æ ‡æ£€æµ‹ä»»åŠ¡å°†è¿æ¥æ›´é«˜çš„å‡†ç¡®æ€§å’Œæ›´å¿«çš„å“åº”é€Ÿåº¦ï¼Œä¸ºæ™ºèƒ½ç›‘æ§ã€è‡ªåŠ¨é©¾é©¶ç­‰é¢†åŸŸå¸¦æ¥æ›´å¤šå¯èƒ½æ€§ã€‚

![18.png](18.png)

### 11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰

#### 11.1 ultralytics\solutions\ai_gym.py

ä»¥ä¸‹æ˜¯å¯¹ç»™å®šä»£ç çš„æ ¸å¿ƒéƒ¨åˆ†è¿›è¡Œåˆ†æå’Œè¯¦ç»†æ³¨é‡Šçš„ç»“æœï¼š

```python
# Ultralytics YOLO ğŸš€, AGPL-3.0 license

import cv2
from ultralytics.utils.checks import check_imshow
from ultralytics.utils.plotting import Annotator

class AIGym:
    """ç®¡ç†åŸºäºå§¿åŠ¿çš„å®æ—¶è§†é¢‘æµä¸­çš„å¥èº«æ­¥éª¤çš„ç±»ã€‚"""

    def __init__(self):
        """åˆå§‹åŒ–AIGymï¼Œè®¾ç½®è§†è§‰å’Œå›¾åƒå‚æ•°çš„é»˜è®¤å€¼ã€‚"""
        self.im0 = None  # å½“å‰å¸§å›¾åƒ
        self.tf = None   # çº¿æ¡åšåº¦

        # å…³é”®ç‚¹å’Œè®¡æ•°ä¿¡æ¯
        self.keypoints = None  # å§¿åŠ¿å…³é”®ç‚¹
        self.poseup_angle = None  # ä¸Šå‡å§¿åŠ¿è§’åº¦
        self.posedown_angle = None  # ä¸‹é™å§¿åŠ¿è§’åº¦
        self.threshold = 0.001  # é˜ˆå€¼

        # å­˜å‚¨é˜¶æ®µã€è®¡æ•°å’Œè§’åº¦ä¿¡æ¯
        self.angle = None  # å½“å‰è§’åº¦
        self.count = None  # å½“å‰è®¡æ•°
        self.stage = None  # å½“å‰é˜¶æ®µ
        self.pose_type = "pushup"  # å§¿åŠ¿ç±»å‹ï¼ˆå¦‚ä¿¯å§æ’‘ï¼‰
        self.kpts_to_check = None  # éœ€è¦æ£€æŸ¥çš„å…³é”®ç‚¹

        # è§†è§‰ä¿¡æ¯
        self.view_img = False  # æ˜¯å¦æ˜¾ç¤ºå›¾åƒ
        self.annotator = None  # æ³¨é‡Šå™¨å®ä¾‹

        # æ£€æŸ¥ç¯å¢ƒæ˜¯å¦æ”¯æŒimshow
        self.env_check = check_imshow(warn=True)

    def set_args(self, kpts_to_check, line_thickness=2, view_img=False, pose_up_angle=145.0, pose_down_angle=90.0, pose_type="pullup"):
        """
        é…ç½®AIGymçš„å‚æ•°ã€‚
        Args:
            kpts_to_check (list): ç”¨äºè®¡æ•°çš„3ä¸ªå…³é”®ç‚¹
            line_thickness (int): è¾¹ç•Œæ¡†çš„çº¿æ¡åšåº¦
            view_img (bool): æ˜¯å¦æ˜¾ç¤ºå›¾åƒ
            pose_up_angle (float): è®¾ç½®ä¸Šå‡å§¿åŠ¿çš„è§’åº¦
            pose_down_angle (float): è®¾ç½®ä¸‹é™å§¿åŠ¿çš„è§’åº¦
            pose_type: "pushup", "pullup" æˆ– "abworkout"
        """
        self.kpts_to_check = kpts_to_check  # è®¾ç½®éœ€è¦æ£€æŸ¥çš„å…³é”®ç‚¹
        self.tf = line_thickness  # è®¾ç½®çº¿æ¡åšåº¦
        self.view_img = view_img  # è®¾ç½®æ˜¯å¦æ˜¾ç¤ºå›¾åƒ
        self.poseup_angle = pose_up_angle  # è®¾ç½®ä¸Šå‡å§¿åŠ¿è§’åº¦
        self.posedown_angle = pose_down_angle  # è®¾ç½®ä¸‹é™å§¿åŠ¿è§’åº¦
        self.pose_type = pose_type  # è®¾ç½®å§¿åŠ¿ç±»å‹

    def start_counting(self, im0, results, frame_count):
        """
        è®¡ç®—å¥èº«æ­¥éª¤çš„å‡½æ•°ã€‚
        Args:
            im0 (ndarray): å½“å‰è§†é¢‘æµå¸§
            results: å§¿åŠ¿ä¼°è®¡æ•°æ®
            frame_count: å½“å‰å¸§è®¡æ•°
        """
        self.im0 = im0  # ä¿å­˜å½“å‰å¸§å›¾åƒ
        if frame_count == 1:
            # åˆå§‹åŒ–è®¡æ•°ã€è§’åº¦å’Œé˜¶æ®µ
            self.count = [0] * len(results[0])
            self.angle = [0] * len(results[0])
            self.stage = ["-" for _ in results[0]]
        
        self.keypoints = results[0].keypoints.data  # è·å–å…³é”®ç‚¹æ•°æ®
        self.annotator = Annotator(im0, line_width=2)  # åˆ›å»ºæ³¨é‡Šå™¨å®ä¾‹

        num_keypoints = len(results[0])  # è·å–å…³é”®ç‚¹æ•°é‡

        # å¦‚æœå…³é”®ç‚¹æ•°é‡å‘ç”Ÿå˜åŒ–ï¼Œè°ƒæ•´è§’åº¦ã€è®¡æ•°å’Œé˜¶æ®µçš„å¤§å°
        if len(self.angle) != num_keypoints:
            self.angle = [0] * num_keypoints
            self.count = [0] * num_keypoints
            self.stage = ["-" for _ in range(num_keypoints)]

        # éå†æ¯ä¸ªå…³é”®ç‚¹ï¼Œè®¡ç®—è§’åº¦å’Œæ›´æ–°è®¡æ•°
        for ind, k in enumerate(reversed(self.keypoints)):
            # è®¡ç®—è§’åº¦
            self.angle[ind] = self.annotator.estimate_pose_angle(
                k[int(self.kpts_to_check[0])].cpu(),
                k[int(self.kpts_to_check[1])].cpu(),
                k[int(self.kpts_to_check[2])].cpu(),
            )
            # ç»˜åˆ¶å…³é”®ç‚¹
            self.im0 = self.annotator.draw_specific_points(k, self.kpts_to_check, shape=(640, 640), radius=10)

            # æ ¹æ®å§¿åŠ¿ç±»å‹æ›´æ–°é˜¶æ®µå’Œè®¡æ•°
            if self.pose_type == "pushup":
                if self.angle[ind] > self.poseup_angle:
                    self.stage[ind] = "up"
                if self.angle[ind] < self.posedown_angle and self.stage[ind] == "up":
                    self.stage[ind] = "down"
                    self.count[ind] += 1

            elif self.pose_type == "pullup":
                if self.angle[ind] > self.poseup_angle:
                    self.stage[ind] = "down"
                if self.angle[ind] < self.posedown_angle and self.stage[ind] == "down":
                    self.stage[ind] = "up"
                    self.count[ind] += 1

            # ç»˜åˆ¶è§’åº¦ã€è®¡æ•°å’Œé˜¶æ®µä¿¡æ¯
            self.annotator.plot_angle_and_count_and_stage(
                angle_text=self.angle[ind],
                count_text=self.count[ind],
                stage_text=self.stage[ind],
                center_kpt=k[int(self.kpts_to_check[1])],
                line_thickness=self.tf,
            )

            # ç»˜åˆ¶æ‰€æœ‰å…³é”®ç‚¹
            self.annotator.kpts(k, shape=(640, 640), radius=1, kpt_line=True)

        # å¦‚æœç¯å¢ƒæ”¯æŒï¼Œæ˜¾ç¤ºå›¾åƒ
        if self.env_check and self.view_img:
            cv2.imshow("Ultralytics YOLOv8 AI GYM", self.im0)
            if cv2.waitKey(1) & 0xFF == ord("q"):
                return

        return self.im0  # è¿”å›å¤„ç†åçš„å›¾åƒ

if __name__ == "__main__":
    AIGym()  # å®ä¾‹åŒ–AIGymç±»
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†åˆ†æ
1. **ç±»å®šä¹‰**ï¼š`AIGym`ç±»ç”¨äºç®¡ç†å¥èº«åŠ¨ä½œçš„è®¡æ•°å’ŒçŠ¶æ€ã€‚
2. **åˆå§‹åŒ–æ–¹æ³•**ï¼š`__init__`æ–¹æ³•è®¾ç½®äº†ä¸€äº›é»˜è®¤å‚æ•°å’Œå˜é‡ï¼Œç”¨äºå­˜å‚¨å›¾åƒã€å…³é”®ç‚¹ã€è®¡æ•°ç­‰ä¿¡æ¯ã€‚
3. **å‚æ•°è®¾ç½®æ–¹æ³•**ï¼š`set_args`æ–¹æ³•å…è®¸ç”¨æˆ·è‡ªå®šä¹‰å…³é”®ç‚¹ã€çº¿æ¡åšåº¦ã€æ˜¯å¦æ˜¾ç¤ºå›¾åƒç­‰å‚æ•°ã€‚
4. **è®¡æ•°æ–¹æ³•**ï¼š`start_counting`æ–¹æ³•æ˜¯æ ¸å¿ƒåŠŸèƒ½ï¼Œè´Ÿè´£å¤„ç†æ¯ä¸€å¸§å›¾åƒï¼Œè®¡ç®—å…³é”®ç‚¹çš„è§’åº¦ï¼Œæ›´æ–°è®¡æ•°å’Œé˜¶æ®µï¼Œå¹¶ç»˜åˆ¶ç›¸åº”çš„å›¾åƒä¿¡æ¯ã€‚
5. **ç¯å¢ƒæ£€æŸ¥å’Œå›¾åƒæ˜¾ç¤º**ï¼šä»£ç ä¸­æ£€æŸ¥ç¯å¢ƒæ˜¯å¦æ”¯æŒå›¾åƒæ˜¾ç¤ºï¼Œå¹¶åœ¨æ”¯æŒçš„æƒ…å†µä¸‹æ˜¾ç¤ºå¤„ç†åçš„å›¾åƒã€‚

é€šè¿‡è¿™äº›æ ¸å¿ƒéƒ¨åˆ†çš„å®ç°ï¼Œ`AIGym`ç±»èƒ½å¤Ÿå®æ—¶ç›‘æµ‹å’Œè®¡æ•°ç”¨æˆ·çš„å¥èº«åŠ¨ä½œã€‚

è¿™ä¸ªæ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸º `AIGym` çš„ç±»ï¼Œä¸»è¦ç”¨äºåœ¨å®æ—¶è§†é¢‘æµä¸­åŸºäºäººä½“å§¿æ€ç®¡ç†å¥èº«åŠ¨ä½œçš„è®¡æ•°ã€‚è¯¥ç±»é€šè¿‡åˆ†æè§†é¢‘æµä¸­çš„å…³é”®ç‚¹æ•°æ®ï¼Œæ¥åˆ¤æ–­ç”¨æˆ·çš„å¥èº«åŠ¨ä½œå¹¶è¿›è¡Œè®¡æ•°ã€‚

åœ¨ç±»çš„åˆå§‹åŒ–æ–¹æ³• `__init__` ä¸­ï¼Œè®¾ç½®äº†ä¸€äº›é»˜è®¤å€¼ï¼ŒåŒ…æ‹¬å›¾åƒå¤„ç†å‚æ•°ã€å…³é”®ç‚¹ä¿¡æ¯ã€è§’åº¦é˜ˆå€¼ã€è®¡æ•°ä¿¡æ¯ã€å½“å‰é˜¶æ®µå’Œå§¿æ€ç±»å‹ç­‰ã€‚`self.im0` ç”¨äºå­˜å‚¨å½“å‰å¸§å›¾åƒï¼Œ`self.tf` è¡¨ç¤ºçº¿æ¡çš„åšåº¦ï¼Œ`self.keypoints` ç”¨äºå­˜å‚¨å…³é”®ç‚¹æ•°æ®ï¼Œ`self.poseup_angle` å’Œ `self.posedown_angle` åˆ†åˆ«è¡¨ç¤ºå§¿æ€çš„ä¸Šå‡å’Œä¸‹é™è§’åº¦é˜ˆå€¼ï¼Œ`self.pose_type` ç”¨äºæŒ‡å®šå½“å‰çš„å¥èº«åŠ¨ä½œç±»å‹ï¼ˆå¦‚ä¿¯å§æ’‘ã€å¼•ä½“å‘ä¸Šæˆ–è…¹éƒ¨é”»ç‚¼ï¼‰ã€‚

`set_args` æ–¹æ³•ç”¨äºé…ç½®ä¸€äº›å‚æ•°ï¼ŒåŒ…æ‹¬éœ€è¦æ£€æŸ¥çš„å…³é”®ç‚¹ã€çº¿æ¡åšåº¦ã€æ˜¯å¦æ˜¾ç¤ºå›¾åƒã€ä¸Šå‡å’Œä¸‹é™çš„è§’åº¦é˜ˆå€¼ä»¥åŠå§¿æ€ç±»å‹ã€‚è¿™äº›å‚æ•°å°†å½±å“åç»­çš„åŠ¨ä½œæ£€æµ‹å’Œè®¡æ•°ã€‚

`start_counting` æ–¹æ³•æ˜¯è¯¥ç±»çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œç”¨äºæ ¹æ®ä¼ å…¥çš„å›¾åƒå¸§å’Œå§¿æ€ä¼°è®¡ç»“æœè¿›è¡Œå¥èº«åŠ¨ä½œçš„è®¡æ•°ã€‚è¯¥æ–¹æ³•é¦–å…ˆä¼šæ£€æŸ¥å½“å‰å¸§çš„è®¡æ•°å’Œè§’åº¦ä¿¡æ¯æ˜¯å¦éœ€è¦åˆå§‹åŒ–ã€‚æ¥ç€ï¼Œå®ƒä¼šéå†æ¯ä¸ªå…³é”®ç‚¹ï¼Œæ ¹æ®ä¸åŒçš„å§¿æ€ç±»å‹ï¼ˆå¦‚ä¿¯å§æ’‘ã€å¼•ä½“å‘ä¸Šæˆ–è…¹éƒ¨é”»ç‚¼ï¼‰è®¡ç®—å½“å‰çš„è§’åº¦ï¼Œå¹¶æ ¹æ®è§’åº¦çš„å˜åŒ–æ›´æ–°åŠ¨ä½œçš„é˜¶æ®µå’Œè®¡æ•°ã€‚è¯¥æ–¹æ³•è¿˜ä¼šè°ƒç”¨ `Annotator` ç±»æ¥ç»˜åˆ¶å…³é”®ç‚¹ã€è§’åº¦ã€è®¡æ•°å’Œé˜¶æ®µä¿¡æ¯ï¼Œå¹¶åœ¨éœ€è¦æ—¶æ˜¾ç¤ºå¤„ç†åçš„å›¾åƒã€‚

æœ€åï¼Œåœ¨ `if __name__ == "__main__":` è¯­å¥ä¸­ï¼Œåˆ›å»ºäº† `AIGym` ç±»çš„ä¸€ä¸ªå®ä¾‹ï¼Œè¡¨æ˜è¯¥æ–‡ä»¶å¯ä»¥ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºè¿è¡Œã€‚æ•´ä½“æ¥çœ‹ï¼Œè¿™ä¸ªç±»æä¾›äº†ä¸€ç§åŸºäºè®¡ç®—æœºè§†è§‰çš„æ–¹å¼æ¥å®æ—¶ç›‘æµ‹å’Œè®¡æ•°å¥èº«åŠ¨ä½œï¼Œé€‚ç”¨äºå¥èº«åº”ç”¨æˆ–è¿åŠ¨åˆ†æã€‚

#### 11.2 ui.py

```python
import sys
import subprocess

def run_script(script_path):
    """
    ä½¿ç”¨å½“å‰ Python ç¯å¢ƒè¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚

    Args:
        script_path (str): è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„

    Returns:
        None
    """
    # è·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„
    python_path = sys.executable

    # æ„å»ºè¿è¡Œå‘½ä»¤
    command = f'"{python_path}" -m streamlit run "{script_path}"'

    # æ‰§è¡Œå‘½ä»¤
    result = subprocess.run(command, shell=True)
    if result.returncode != 0:
        print("è„šæœ¬è¿è¡Œå‡ºé”™ã€‚")


# å®ä¾‹åŒ–å¹¶è¿è¡Œåº”ç”¨
if __name__ == "__main__":
    # æŒ‡å®šæ‚¨çš„è„šæœ¬è·¯å¾„
    script_path = "web.py"  # è¿™é‡Œå¯ä»¥ç›´æ¥æŒ‡å®šè„šæœ¬è·¯å¾„

    # è¿è¡Œè„šæœ¬
    run_script(script_path)
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†åŠæ³¨é‡Šï¼š

1. **å¯¼å…¥å¿…è¦çš„æ¨¡å—**ï¼š
   - `sys`ï¼šç”¨äºè®¿é—®ä¸ Python è§£é‡Šå™¨ç›¸å…³çš„å˜é‡å’Œå‡½æ•°ã€‚
   - `subprocess`ï¼šç”¨äºæ‰§è¡Œå¤–éƒ¨å‘½ä»¤ã€‚

2. **å®šä¹‰ `run_script` å‡½æ•°**ï¼š
   - è¯¥å‡½æ•°æ¥å—ä¸€ä¸ªå‚æ•° `script_path`ï¼Œè¡¨ç¤ºè¦è¿è¡Œçš„ Python è„šæœ¬çš„è·¯å¾„ã€‚
   - å‡½æ•°å†…éƒ¨é¦–å…ˆè·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ï¼Œæ„å»ºè¿è¡Œå‘½ä»¤ï¼Œç„¶åé€šè¿‡ `subprocess.run` æ‰§è¡Œè¯¥å‘½ä»¤ã€‚

3. **å‘½ä»¤æ„å»º**ï¼š
   - ä½¿ç”¨ `-m streamlit run` æ¥è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ï¼Œè¿™é‡Œå‡è®¾ä½¿ç”¨çš„æ˜¯ Streamlit æ¡†æ¶ã€‚

4. **é”™è¯¯å¤„ç†**ï¼š
   - å¦‚æœè„šæœ¬è¿è¡Œå¤±è´¥ï¼ˆå³è¿”å›ç ä¸ä¸º 0ï¼‰ï¼Œåˆ™æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚

5. **ä¸»ç¨‹åºå…¥å£**ï¼š
   - ä½¿ç”¨ `if __name__ == "__main__":` ç¡®ä¿åªæœ‰åœ¨ç›´æ¥è¿è¡Œè¯¥è„šæœ¬æ—¶æ‰ä¼šæ‰§è¡Œä»¥ä¸‹ä»£ç ã€‚
   - æŒ‡å®šè¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ï¼ˆè¿™é‡Œç›´æ¥ä½¿ç”¨äº† `"web.py"`ï¼‰ã€‚
   - è°ƒç”¨ `run_script` å‡½æ•°æ¥æ‰§è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶åä¸º `ui.py`ï¼Œå…¶ä¸»è¦åŠŸèƒ½æ˜¯é€šè¿‡å½“å‰çš„ Python ç¯å¢ƒè¿è¡Œä¸€ä¸ªæŒ‡å®šçš„è„šæœ¬ï¼Œå…·ä½“æ¥è¯´æ˜¯ä¸€ä¸ªåä¸º `web.py` çš„è„šæœ¬ã€‚ç¨‹åºé¦–å…ˆå¯¼å…¥äº†å¿…è¦çš„æ¨¡å—ï¼ŒåŒ…æ‹¬ `sys`ã€`os` å’Œ `subprocess`ï¼Œä»¥åŠä¸€ä¸ªè‡ªå®šä¹‰çš„è·¯å¾„å¤„ç†å‡½æ•° `abs_path`ã€‚

åœ¨ `run_script` å‡½æ•°ä¸­ï¼Œé¦–å…ˆè·å–å½“å‰ Python è§£é‡Šå™¨çš„è·¯å¾„ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„ Python ç¯å¢ƒæ¥è¿è¡Œè„šæœ¬ã€‚æ¥ç€ï¼Œæ„å»ºä¸€ä¸ªå‘½ä»¤å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå‘½ä»¤ä½¿ç”¨ `streamlit` æ¨¡å—æ¥è¿è¡ŒæŒ‡å®šçš„è„šæœ¬ã€‚`streamlit` æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºæ•°æ®åº”ç”¨çš„åº“ï¼Œå› æ­¤è¿™ä¸ªç¨‹åºçš„ç›®çš„å¯èƒ½æ˜¯å¯åŠ¨ä¸€ä¸ªåŸºäº `streamlit` çš„ web åº”ç”¨ã€‚

ç„¶åï¼Œä½¿ç”¨ `subprocess.run` æ–¹æ³•æ‰§è¡Œæ„å»ºå¥½çš„å‘½ä»¤ã€‚è¿™ä¸ªæ–¹æ³•ä¼šåœ¨æ–°çš„ shell ä¸­è¿è¡Œå‘½ä»¤ï¼Œå¹¶ç­‰å¾…å…¶å®Œæˆã€‚å¦‚æœè„šæœ¬è¿è¡Œè¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ï¼Œè¿”å›çš„ `returncode` å°†ä¸ä¸ºé›¶ï¼Œç¨‹åºä¼šæ‰“å°å‡ºâ€œè„šæœ¬è¿è¡Œå‡ºé”™â€çš„æç¤ºä¿¡æ¯ã€‚

åœ¨æ–‡ä»¶çš„æœ€åéƒ¨åˆ†ï¼Œä½¿ç”¨ `if __name__ == "__main__":` è¯­å¥æ¥ç¡®ä¿åªæœ‰åœ¨ç›´æ¥è¿è¡Œ `ui.py` æ—¶æ‰ä¼šæ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚è¿™éƒ¨åˆ†ä»£ç æŒ‡å®šäº†è¦è¿è¡Œçš„è„šæœ¬è·¯å¾„ï¼ˆé€šè¿‡ `abs_path` å‡½æ•°è·å– `web.py` çš„ç»å¯¹è·¯å¾„ï¼‰ï¼Œç„¶åè°ƒç”¨ `run_script` å‡½æ•°æ¥å¯åŠ¨è¿™ä¸ªè„šæœ¬ã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªç¨‹åºçš„ä¸»è¦åŠŸèƒ½æ˜¯æä¾›ä¸€ä¸ªç®€å•çš„æ¥å£ï¼Œé€šè¿‡å‘½ä»¤è¡Œå¯åŠ¨ä¸€ä¸ª `streamlit` åº”ç”¨ï¼Œä¾¿äºç”¨æˆ·åœ¨å½“å‰çš„ Python ç¯å¢ƒä¸­è¿è¡Œç‰¹å®šçš„è„šæœ¬ã€‚

#### 11.3 ultralytics\models\yolo\classify\predict.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import cv2
import torch
from PIL import Image
from ultralytics.engine.predictor import BasePredictor
from ultralytics.engine.results import Results
from ultralytics.utils import ops

class ClassificationPredictor(BasePredictor):
    """
    ClassificationPredictorç±»ï¼Œç»§æ‰¿è‡ªBasePredictorç±»ï¼Œç”¨äºåŸºäºåˆ†ç±»æ¨¡å‹è¿›è¡Œé¢„æµ‹ã€‚
    """

    def __init__(self, cfg=DEFAULT_CFG, overrides=None, _callbacks=None):
        """åˆå§‹åŒ–ClassificationPredictorï¼Œå°†ä»»åŠ¡è®¾ç½®ä¸º'åˆ†ç±»'ã€‚"""
        super().__init__(cfg, overrides, _callbacks)  # è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°
        self.args.task = "classify"  # è®¾ç½®ä»»åŠ¡ç±»å‹ä¸ºåˆ†ç±»
        self._legacy_transform_name = "ultralytics.yolo.data.augment.ToTensor"  # æ—§ç‰ˆè½¬æ¢åç§°

    def preprocess(self, img):
        """å°†è¾“å…¥å›¾åƒè½¬æ¢ä¸ºæ¨¡å‹å…¼å®¹çš„æ•°æ®ç±»å‹ã€‚"""
        if not isinstance(img, torch.Tensor):  # å¦‚æœè¾“å…¥ä¸æ˜¯torchå¼ é‡
            is_legacy_transform = any(
                self._legacy_transform_name in str(transform) for transform in self.transforms.transforms
            )
            if is_legacy_transform:  # å¤„ç†æ—§ç‰ˆè½¬æ¢
                img = torch.stack([self.transforms(im) for im in img], dim=0)  # åº”ç”¨è½¬æ¢å¹¶å †å 
            else:
                img = torch.stack(
                    [self.transforms(Image.fromarray(cv2.cvtColor(im, cv2.COLOR_BGR2RGB))) for im in img], dim=0
                )  # å°†BGRå›¾åƒè½¬æ¢ä¸ºRGBå¹¶åº”ç”¨è½¬æ¢
        img = (img if isinstance(img, torch.Tensor) else torch.from_numpy(img)).to(self.model.device)  # è½¬æ¢ä¸ºå¼ é‡å¹¶ç§»åŠ¨åˆ°æ¨¡å‹è®¾å¤‡
        return img.half() if self.model.fp16 else img.float()  # å°†uint8è½¬æ¢ä¸ºfp16æˆ–fp32

    def postprocess(self, preds, img, orig_imgs):
        """å¯¹é¢„æµ‹ç»“æœè¿›è¡Œåå¤„ç†ï¼Œè¿”å›Resultså¯¹è±¡ã€‚"""
        if not isinstance(orig_imgs, list):  # å¦‚æœåŸå§‹å›¾åƒä¸æ˜¯åˆ—è¡¨
            orig_imgs = ops.convert_torch2numpy_batch(orig_imgs)  # è½¬æ¢ä¸ºnumpyæ•°ç»„

        results = []
        for i, pred in enumerate(preds):  # éå†æ¯ä¸ªé¢„æµ‹ç»“æœ
            orig_img = orig_imgs[i]  # è·å–å¯¹åº”çš„åŸå§‹å›¾åƒ
            img_path = self.batch[0][i]  # è·å–å›¾åƒè·¯å¾„
            results.append(Results(orig_img, path=img_path, names=self.model.names, probs=pred))  # åˆ›å»ºResultså¯¹è±¡å¹¶æ·»åŠ åˆ°ç»“æœåˆ—è¡¨
        return results  # è¿”å›ç»“æœåˆ—è¡¨
```

### ä»£ç è¯´æ˜ï¼š
1. **å¯¼å…¥åº“**ï¼šå¯¼å…¥å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬OpenCVã€PyTorchå’ŒPILç­‰ã€‚
2. **ClassificationPredictorç±»**ï¼šè¯¥ç±»ç”¨äºå›¾åƒåˆ†ç±»ä»»åŠ¡ï¼Œç»§æ‰¿è‡ª`BasePredictor`ï¼Œå¹¶é‡å†™äº†åˆå§‹åŒ–ã€é¢„å¤„ç†å’Œåå¤„ç†æ–¹æ³•ã€‚
3. **åˆå§‹åŒ–æ–¹æ³•**ï¼šè®¾ç½®ä»»åŠ¡ç±»å‹ä¸ºåˆ†ç±»ï¼Œå¹¶å®šä¹‰æ—§ç‰ˆè½¬æ¢åç§°ã€‚
4. **é¢„å¤„ç†æ–¹æ³•**ï¼šå°†è¾“å…¥å›¾åƒè½¬æ¢ä¸ºé€‚åˆæ¨¡å‹è¾“å…¥çš„æ ¼å¼ï¼ŒåŒ…æ‹¬å¤„ç†å›¾åƒçš„é¢œè‰²é€šé“å’Œæ•°æ®ç±»å‹ã€‚
5. **åå¤„ç†æ–¹æ³•**ï¼šå¯¹æ¨¡å‹çš„é¢„æµ‹ç»“æœè¿›è¡Œå¤„ç†ï¼Œç”ŸæˆåŒ…å«åŸå§‹å›¾åƒã€è·¯å¾„ã€ç±»åˆ«åç§°å’Œæ¦‚ç‡çš„ç»“æœå¯¹è±¡åˆ—è¡¨ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶æ˜¯ä¸€ä¸ªç”¨äºå›¾åƒåˆ†ç±»çš„é¢„æµ‹å™¨ï¼Œå±äºUltralytics YOLOæ¡†æ¶çš„ä¸€éƒ¨åˆ†ã€‚å®ƒç»§æ‰¿è‡ª`BasePredictor`ç±»ï¼Œä¸“é—¨ç”¨äºå¤„ç†åˆ†ç±»æ¨¡å‹çš„é¢„æµ‹ä»»åŠ¡ã€‚æ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½æ˜¯åŠ è½½æ¨¡å‹ã€é¢„å¤„ç†è¾“å…¥å›¾åƒã€è¿›è¡Œé¢„æµ‹ï¼Œå¹¶å¯¹é¢„æµ‹ç»“æœè¿›è¡Œåå¤„ç†ã€‚

é¦–å…ˆï¼Œæ–‡ä»¶å¯¼å…¥äº†å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬`cv2`ç”¨äºå›¾åƒå¤„ç†ï¼Œ`torch`ç”¨äºæ·±åº¦å­¦ä¹ æ¨¡å‹çš„æ“ä½œï¼Œä»¥åŠ`PIL`ç”¨äºå›¾åƒçš„åŠ è½½å’Œå¤„ç†ã€‚æ¥ç€ï¼Œæ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸º`ClassificationPredictor`çš„ç±»ï¼Œè¯¥ç±»æ‰©å±•äº†`BasePredictor`ç±»ï¼Œå¹¶è®¾ç½®ä»»åŠ¡ç±»å‹ä¸ºâ€œåˆ†ç±»â€ã€‚

åœ¨æ„é€ å‡½æ•°`__init__`ä¸­ï¼Œè°ƒç”¨äº†çˆ¶ç±»çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œå¹¶å°†ä»»åŠ¡ç±»å‹è®¾ç½®ä¸ºâ€œclassifyâ€ã€‚åŒæ—¶ï¼Œå®ƒè¿˜å®šä¹‰äº†ä¸€ä¸ªç”¨äºå¤„ç†æ—§ç‰ˆè½¬æ¢çš„å˜é‡`_legacy_transform_name`ã€‚

`preprocess`æ–¹æ³•ç”¨äºå°†è¾“å…¥å›¾åƒè½¬æ¢ä¸ºæ¨¡å‹å¯ä»¥æ¥å—çš„æ•°æ®ç±»å‹ã€‚å®ƒé¦–å…ˆæ£€æŸ¥è¾“å…¥æ˜¯å¦ä¸º`torch.Tensor`ç±»å‹ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™æ ¹æ®æ˜¯å¦ä½¿ç”¨äº†æ—§ç‰ˆè½¬æ¢è¿›è¡Œä¸åŒçš„å¤„ç†ã€‚å¯¹äºæ¯ä¸ªå›¾åƒï¼Œä½¿ç”¨`cv2`å°†å…¶è½¬æ¢ä¸ºRGBæ ¼å¼ï¼Œç„¶ååº”ç”¨é¢„å®šä¹‰çš„è½¬æ¢ï¼Œæœ€åå°†å›¾åƒè½¬æ¢ä¸ºé€‚åˆæ¨¡å‹çš„æ ¼å¼ï¼Œå¹¶ç§»åŠ¨åˆ°ç›¸åº”çš„è®¾å¤‡ä¸Šï¼ˆå¦‚GPUï¼‰ã€‚åœ¨å¤„ç†è¿‡ç¨‹ä¸­ï¼Œå›¾åƒçš„æ•°æ®ç±»å‹ä¼šè¢«è½¬æ¢ä¸ºåŠç²¾åº¦æˆ–å•ç²¾åº¦æµ®ç‚¹æ•°ï¼Œä»¥é€‚åº”æ¨¡å‹çš„è¦æ±‚ã€‚

`postprocess`æ–¹æ³•åˆ™è´Ÿè´£å¯¹æ¨¡å‹çš„é¢„æµ‹ç»“æœè¿›è¡Œåå¤„ç†ï¼Œç”Ÿæˆ`Results`å¯¹è±¡ã€‚å®ƒé¦–å…ˆæ£€æŸ¥åŸå§‹å›¾åƒæ˜¯å¦ä¸ºåˆ—è¡¨ç±»å‹ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™å°†å…¶è½¬æ¢ä¸ºNumPyæ•°ç»„ã€‚ç„¶åï¼Œå¯¹äºæ¯ä¸ªé¢„æµ‹ç»“æœï¼Œç»“åˆåŸå§‹å›¾åƒå’Œå›¾åƒè·¯å¾„ï¼Œåˆ›å»ºä¸€ä¸ª`Results`å¯¹è±¡ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°ç»“æœåˆ—è¡¨ä¸­ï¼Œæœ€ç»ˆè¿”å›è¿™ä¸ªåˆ—è¡¨ã€‚

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶å®ç°äº†å›¾åƒåˆ†ç±»çš„é¢„æµ‹æµç¨‹ï¼ŒåŒ…æ‹¬å›¾åƒçš„é¢„å¤„ç†ã€æ¨¡å‹é¢„æµ‹å’Œç»“æœçš„åå¤„ç†ï¼Œèƒ½å¤Ÿæ”¯æŒå¤šç§åˆ†ç±»æ¨¡å‹çš„ä½¿ç”¨ã€‚

#### 11.4 ultralytics\models\fastsam\prompt.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import os
import numpy as np
import torch
from PIL import Image
import cv2
from ultralytics.utils import TQDM

class FastSAMPrompt:
    """
    Fast Segment Anything Model ç±»ï¼Œç”¨äºå›¾åƒæ³¨é‡Šå’Œå¯è§†åŒ–ã€‚

    å±æ€§:
        device (str): è®¡ç®—è®¾å¤‡ï¼ˆ'cuda' æˆ– 'cpu'ï¼‰ã€‚
        results: ç›®æ ‡æ£€æµ‹æˆ–åˆ†å‰²ç»“æœã€‚
        source: æºå›¾åƒæˆ–å›¾åƒè·¯å¾„ã€‚
        clip: ç”¨äºçº¿æ€§åˆ†é…çš„ CLIP æ¨¡å‹ã€‚
    """

    def __init__(self, source, results, device="cuda") -> None:
        """åˆå§‹åŒ– FastSAMPromptï¼Œè®¾ç½®æºå›¾åƒã€ç»“æœå’Œè®¾å¤‡ï¼Œå¹¶å¯¼å…¥ CLIP æ¨¡å‹ã€‚"""
        self.device = device
        self.results = results
        self.source = source

        # å¯¼å…¥å¹¶åˆ†é… CLIP æ¨¡å‹
        try:
            import clip  # ç”¨äºçº¿æ€§åˆ†é…
        except ImportError:
            from ultralytics.utils.checks import check_requirements
            check_requirements("git+https://github.com/openai/CLIP.git")
            import clip
        self.clip = clip

    @staticmethod
    def _format_results(result, filter=0):
        """å°†æ£€æµ‹ç»“æœæ ¼å¼åŒ–ä¸ºåŒ…å« IDã€åˆ†å‰²ã€è¾¹ç•Œæ¡†ã€å¾—åˆ†å’Œé¢ç§¯çš„æ³¨é‡Šåˆ—è¡¨ã€‚"""
        annotations = []
        n = len(result.masks.data) if result.masks is not None else 0
        for i in range(n):
            mask = result.masks.data[i] == 1.0
            if torch.sum(mask) >= filter:
                annotation = {
                    "id": i,
                    "segmentation": mask.cpu().numpy(),
                    "bbox": result.boxes.data[i],
                    "score": result.boxes.conf[i],
                }
                annotation["area"] = annotation["segmentation"].sum()
                annotations.append(annotation)
        return annotations

    @torch.no_grad()
    def retrieve(self, model, preprocess, elements, search_text: str, device) -> int:
        """å¤„ç†å›¾åƒå’Œæ–‡æœ¬ï¼Œè®¡ç®—ç›¸ä¼¼åº¦ï¼Œå¹¶è¿”å› softmax åˆ†æ•°ã€‚"""
        preprocessed_images = [preprocess(image).to(device) for image in elements]
        tokenized_text = self.clip.tokenize([search_text]).to(device)
        stacked_images = torch.stack(preprocessed_images)
        image_features = model.encode_image(stacked_images)
        text_features = model.encode_text(tokenized_text)
        image_features /= image_features.norm(dim=-1, keepdim=True)
        text_features /= text_features.norm(dim=-1, keepdim=True)
        probs = 100.0 * image_features @ text_features.T
        return probs[:, 0].softmax(dim=0)

    def text_prompt(self, text):
        """å¤„ç†æ–‡æœ¬æç¤ºï¼Œå°†å…¶åº”ç”¨äºç°æœ‰ç»“æœå¹¶è¿”å›æ›´æ–°çš„ç»“æœã€‚"""
        if self.results[0].masks is not None:
            format_results = self._format_results(self.results[0], 0)
            cropped_boxes, cropped_images, not_crop, filter_id, annotations = self._crop_image(format_results)
            clip_model, preprocess = self.clip.load("ViT-B/32", device=self.device)
            scores = self.retrieve(clip_model, preprocess, cropped_boxes, text, device=self.device)
            max_idx = scores.argsort()[-1]  # è·å–å¾—åˆ†æœ€é«˜çš„ç´¢å¼•
            max_idx += sum(np.array(filter_id) <= int(max_idx))  # å¤„ç†è¿‡æ»¤çš„ç´¢å¼•
            self.results[0].masks.data = torch.tensor(np.array([annotations[max_idx]["segmentation"]]))
        return self.results

    def everything_prompt(self):
        """è¿”å›ç±»ä¸­ä¹‹å‰æ–¹æ³•å¤„ç†åçš„ç»“æœã€‚"""
        return self.results
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è¯´æ˜ï¼š

1. **ç±»å®šä¹‰**ï¼š`FastSAMPrompt`ç±»ç”¨äºå›¾åƒåˆ†å‰²å’Œæ³¨é‡Šï¼ŒåŒ…å«äº†è®¾å¤‡é€‰æ‹©ã€ç»“æœå­˜å‚¨å’Œæºå›¾åƒè·¯å¾„ç­‰å±æ€§ã€‚

2. **åˆå§‹åŒ–æ–¹æ³•**ï¼š`__init__`æ–¹æ³•è´Ÿè´£åˆå§‹åŒ–ç±»çš„å±æ€§ï¼Œå¹¶å¯¼å…¥CLIPæ¨¡å‹ï¼Œç”¨äºåç»­çš„æ–‡æœ¬å¤„ç†å’Œå›¾åƒç‰¹å¾æå–ã€‚

3. **ç»“æœæ ¼å¼åŒ–**ï¼š`_format_results`æ–¹æ³•å°†æ£€æµ‹ç»“æœæ ¼å¼åŒ–ä¸ºæ˜“äºå¤„ç†çš„æ³¨é‡Šåˆ—è¡¨ï¼ŒåŒ…å«æ¯ä¸ªåˆ†å‰²çš„IDã€åˆ†å‰²æ©ç ã€è¾¹ç•Œæ¡†ã€å¾—åˆ†å’Œé¢ç§¯ã€‚

4. **ç›¸ä¼¼åº¦è®¡ç®—**ï¼š`retrieve`æ–¹æ³•ä½¿ç”¨CLIPæ¨¡å‹å¤„ç†å›¾åƒå’Œæ–‡æœ¬ï¼Œè®¡ç®—å®ƒä»¬ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œå¹¶è¿”å›softmaxåˆ†æ•°ï¼Œä¾¿äºåç»­é€‰æ‹©æœ€ç›¸å…³çš„åˆ†å‰²ç»“æœã€‚

5. **æ–‡æœ¬æç¤ºå¤„ç†**ï¼š`text_prompt`æ–¹æ³•æ¥æ”¶æ–‡æœ¬è¾“å…¥ï¼Œå¤„ç†å¹¶æ›´æ–°åˆ†å‰²ç»“æœï¼Œåˆ©ç”¨ä¹‹å‰æ ¼å¼åŒ–çš„ç»“æœå’ŒCLIPæ¨¡å‹è¿›è¡Œç›¸ä¼¼åº¦è®¡ç®—ï¼Œé€‰æ‹©æœ€ç›¸å…³çš„åˆ†å‰²æ©ç ã€‚

6. **è·å–æ‰€æœ‰ç»“æœ**ï¼š`everything_prompt`æ–¹æ³•è¿”å›å½“å‰å¤„ç†çš„ç»“æœï¼Œä¾¿äºå¤–éƒ¨è°ƒç”¨ã€‚

è¿™äº›æ ¸å¿ƒéƒ¨åˆ†æ„æˆäº†å›¾åƒåˆ†å‰²å’Œæ³¨é‡Šçš„åŸºç¡€é€»è¾‘ï¼Œèƒ½å¤Ÿæ ¹æ®ç”¨æˆ·è¾“å…¥çš„æ–‡æœ¬æç¤ºåŠ¨æ€æ›´æ–°åˆ†å‰²ç»“æœã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸º `FastSAMPrompt` çš„ç±»ï¼Œä¸»è¦ç”¨äºå›¾åƒæ³¨é‡Šå’Œå¯è§†åŒ–ï¼Œç‰¹åˆ«æ˜¯åœ¨ç›®æ ‡æ£€æµ‹å’Œåˆ†å‰²ä»»åŠ¡ä¸­ã€‚è¯¥ç±»çš„æ„é€ å‡½æ•°æ¥å—æºå›¾åƒã€æ£€æµ‹ç»“æœå’Œè®¡ç®—è®¾å¤‡ï¼ˆå¦‚ CUDA æˆ– CPUï¼‰ä½œä¸ºå‚æ•°ï¼Œå¹¶å°è¯•å¯¼å…¥ CLIP æ¨¡å‹ç”¨äºçº¿æ€§åˆ†é…ã€‚

ç±»ä¸­åŒ…å«å¤šä¸ªé™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•ï¼Œä¸»è¦åŠŸèƒ½åŒ…æ‹¬å›¾åƒåˆ†å‰²ã€ç»“æœæ ¼å¼åŒ–ã€è¾¹ç•Œæ¡†æå–ã€ç»˜å›¾ã€æ©ç æ˜¾ç¤ºã€å›¾åƒæ£€ç´¢ã€å›¾åƒè£å‰ªä»¥åŠåŸºäºç”¨æˆ·è¾“å…¥çš„ç‚¹å’Œæ–‡æœ¬æç¤ºã€‚

åœ¨ `_segment_image` æ–¹æ³•ä¸­ï¼Œæ ¹æ®ç»™å®šçš„è¾¹ç•Œæ¡†åæ ‡å¯¹å›¾åƒè¿›è¡Œåˆ†å‰²ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„å›¾åƒï¼Œå…¶ä¸­åªæœ‰æŒ‡å®šåŒºåŸŸçš„å†…å®¹è¢«ä¿ç•™ã€‚`_format_results` æ–¹æ³•å°†æ£€æµ‹ç»“æœæ ¼å¼åŒ–ä¸ºåŒ…å« IDã€åˆ†å‰²æ©ç ã€è¾¹ç•Œæ¡†ã€ç½®ä¿¡åº¦å’Œé¢ç§¯çš„æ³¨é‡Šåˆ—è¡¨ã€‚`_get_bbox_from_mask` æ–¹æ³•é€šè¿‡å¯¹æ©ç åº”ç”¨å½¢æ€å­¦å˜æ¢æ¥æå–è¾¹ç•Œæ¡†ã€‚

`plot` æ–¹æ³•ç”¨äºåœ¨å›¾åƒä¸Šç»˜åˆ¶æ³¨é‡Šã€è¾¹ç•Œæ¡†å’Œç‚¹ï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°æŒ‡å®šçš„è¾“å‡ºç›®å½•ã€‚å®ƒä½¿ç”¨ `TQDM` åº“æ˜¾ç¤ºè¿›åº¦æ¡ï¼Œæ”¯æŒéšæœºé¢œè‰²æ©ç ã€è½®å»“ç»˜åˆ¶ç­‰é€‰é¡¹ã€‚`fast_show_mask` æ–¹æ³•åˆ™åœ¨ç»™å®šçš„ matplotlib è½´ä¸Šå¿«é€Ÿæ˜¾ç¤ºæ©ç æ³¨é‡Šã€‚

`retrieve` æ–¹æ³•é€šè¿‡å¤„ç†å›¾åƒå’Œæ–‡æœ¬ï¼Œè®¡ç®—ç›¸ä¼¼åº¦å¹¶è¿”å› softmax åˆ†æ•°ã€‚`_crop_image` æ–¹æ³•æ ¹æ®æä¾›çš„æ³¨é‡Šæ ¼å¼è£å‰ªå›¾åƒï¼Œè¿”å›è£å‰ªåçš„å›¾åƒå’Œç›¸å…³æ•°æ®ã€‚

ç±»ä¸­è¿˜å®ç°äº† `box_prompt`ã€`point_prompt` å’Œ `text_prompt` æ–¹æ³•ï¼Œåˆ†åˆ«ç”¨äºæ ¹æ®è¾¹ç•Œæ¡†ã€ç‚¹å’Œæ–‡æœ¬æç¤ºè°ƒæ•´æ©ç ã€‚è¿™äº›æ–¹æ³•ä¼šæ›´æ–°ç»“æœä¸­çš„æ©ç æ•°æ®ï¼Œè¿”å›å¤„ç†åçš„ç»“æœã€‚

æœ€åï¼Œ`everything_prompt` æ–¹æ³•è¿”å›ä¹‹å‰å¤„ç†çš„ç»“æœã€‚æ•´ä¸ªç±»çš„è®¾è®¡æ—¨åœ¨æä¾›ä¸€ä¸ªçµæ´»çš„æ¥å£ï¼Œä»¥ä¾¿ç”¨æˆ·èƒ½å¤Ÿé€šè¿‡ä¸åŒçš„æ–¹å¼ä¸å›¾åƒåˆ†å‰²ç»“æœè¿›è¡Œäº¤äº’å’Œè°ƒæ•´ã€‚

#### 11.5 ultralytics\models\yolo\obb\train.py

ä»¥ä¸‹æ˜¯ç»è¿‡ç®€åŒ–å¹¶æ³¨é‡Šçš„æ ¸å¿ƒä»£ç éƒ¨åˆ†ï¼š

```python
# å¯¼å…¥å¿…è¦çš„æ¨¡å—
from copy import copy
from ultralytics.models import yolo
from ultralytics.nn.tasks import OBBModel
from ultralytics.utils import DEFAULT_CFG, RANK

class OBBTrainer(yolo.detect.DetectionTrainer):
    """
    OBBTrainerç±»ï¼Œç»§æ‰¿è‡ªDetectionTrainerç±»ï¼Œç”¨äºåŸºäºå®šå‘è¾¹ç•Œæ¡†ï¼ˆOBBï¼‰æ¨¡å‹çš„è®­ç»ƒã€‚
    """

    def __init__(self, cfg=DEFAULT_CFG, overrides=None, _callbacks=None):
        """åˆå§‹åŒ–OBBTrainerå¯¹è±¡ï¼Œè®¾ç½®é…ç½®å’Œå‚æ•°è¦†ç›–ã€‚"""
        if overrides is None:
            overrides = {}
        overrides["task"] = "obb"  # è®¾ç½®ä»»åŠ¡ç±»å‹ä¸ºOBB
        super().__init__(cfg, overrides, _callbacks)  # è°ƒç”¨çˆ¶ç±»åˆå§‹åŒ–æ–¹æ³•

    def get_model(self, cfg=None, weights=None, verbose=True):
        """è¿”å›åˆå§‹åŒ–çš„OBBModelæ¨¡å‹ï¼Œä½¿ç”¨æŒ‡å®šçš„é…ç½®å’Œæƒé‡ã€‚"""
        # åˆ›å»ºOBBModelå®ä¾‹ï¼ŒæŒ‡å®šè¾“å…¥é€šé“æ•°å’Œç±»åˆ«æ•°
        model = OBBModel(cfg, ch=3, nc=self.data["nc"], verbose=verbose and RANK == -1)
        if weights:
            model.load(weights)  # å¦‚æœæä¾›äº†æƒé‡ï¼Œåˆ™åŠ è½½æƒé‡

        return model  # è¿”å›æ¨¡å‹å®ä¾‹

    def get_validator(self):
        """è¿”å›OBBValidatorå®ä¾‹ï¼Œç”¨äºYOLOæ¨¡å‹çš„éªŒè¯ã€‚"""
        self.loss_names = "box_loss", "cls_loss", "dfl_loss"  # å®šä¹‰æŸå¤±åç§°
        # åˆ›å»ºå¹¶è¿”å›OBBValidatorå®ä¾‹
        return yolo.obb.OBBValidator(self.test_loader, save_dir=self.save_dir, args=copy(self.args))
```

### ä»£ç æ³¨é‡Šè¯´æ˜ï¼š
1. **å¯¼å…¥æ¨¡å—**ï¼šå¼•å…¥å¿…è¦çš„æ¨¡å—å’Œç±»ï¼Œæ–¹ä¾¿åç»­ä½¿ç”¨ã€‚
2. **OBBTrainerç±»**ï¼šè¯¥ç±»ç”¨äºè®­ç»ƒåŸºäºå®šå‘è¾¹ç•Œæ¡†çš„YOLOæ¨¡å‹ï¼Œç»§æ‰¿è‡ªå·²æœ‰çš„DetectionTrainerç±»ã€‚
3. **åˆå§‹åŒ–æ–¹æ³•**ï¼šåœ¨åˆå§‹åŒ–æ—¶è®¾ç½®ä»»åŠ¡ç±»å‹ä¸ºOBBï¼Œå¹¶è°ƒç”¨çˆ¶ç±»çš„åˆå§‹åŒ–æ–¹æ³•ã€‚
4. **è·å–æ¨¡å‹æ–¹æ³•**ï¼šåˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªOBBModelå®ä¾‹ï¼Œæ”¯æŒåŠ è½½é¢„è®­ç»ƒæƒé‡ã€‚
5. **è·å–éªŒè¯å™¨æ–¹æ³•**ï¼šè¿”å›ä¸€ä¸ªOBBValidatorå®ä¾‹ï¼Œç”¨äºæ¨¡å‹çš„éªŒè¯ï¼Œå¹¶å®šä¹‰äº†æŸå¤±åç§°ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªåä¸º `OBBTrainer` çš„ç±»ï¼Œè¯¥ç±»ç”¨äºåŸºäºå®šå‘è¾¹ç•Œæ¡†ï¼ˆOriented Bounding Box, OBBï¼‰æ¨¡å‹è¿›è¡Œè®­ç»ƒã€‚`OBBTrainer` ç»§æ‰¿è‡ª `yolo.detect.DetectionTrainer` ç±»ï¼Œæ‰©å±•äº†å…¶åŠŸèƒ½ä»¥é€‚åº” OBB æ¨¡å‹çš„è®­ç»ƒéœ€æ±‚ã€‚

åœ¨æ–‡ä»¶çš„å¼€å¤´ï¼Œå¯¼å…¥äº†ä¸€äº›å¿…è¦çš„æ¨¡å—å’Œç±»ï¼ŒåŒ…æ‹¬ `copy` æ¨¡å—ã€`yolo` æ¨¡å—ä¸­çš„ç›¸å…³åŠŸèƒ½ã€`OBBModel` ç±»ä»¥åŠä¸€äº›å·¥å…·å‡½æ•°å’Œå¸¸é‡ã€‚

`OBBTrainer` ç±»çš„æ„é€ å‡½æ•° `__init__` æ¥å—ä¸‰ä¸ªå‚æ•°ï¼š`cfg`ï¼ˆé…ç½®æ–‡ä»¶ï¼Œé»˜è®¤ä¸º `DEFAULT_CFG`ï¼‰ã€`overrides`ï¼ˆç”¨äºè¦†ç›–é»˜è®¤å‚æ•°çš„å­—å…¸ï¼Œé»˜è®¤ä¸º `None`ï¼‰å’Œ `_callbacks`ï¼ˆå›è°ƒå‡½æ•°ï¼Œé»˜è®¤ä¸º `None`ï¼‰ã€‚åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œå¦‚æœ `overrides` ä¸º `None`ï¼Œåˆ™åˆå§‹åŒ–ä¸ºç©ºå­—å…¸ï¼Œå¹¶å°†ä»»åŠ¡ç±»å‹è®¾ç½®ä¸º "obb"ã€‚ç„¶åï¼Œè°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ä»¥å®Œæˆåˆå§‹åŒ–ã€‚

`get_model` æ–¹æ³•ç”¨äºè¿”å›ä¸€ä¸ªåˆå§‹åŒ–çš„ `OBBModel` å®ä¾‹ã€‚è¯¥æ–¹æ³•æ¥å—ä¸‰ä¸ªå‚æ•°ï¼š`cfg`ï¼ˆé…ç½®æ–‡ä»¶ï¼‰ã€`weights`ï¼ˆæƒé‡æ–‡ä»¶ï¼‰å’Œ `verbose`ï¼ˆæ˜¯å¦æ‰“å°è¯¦ç»†ä¿¡æ¯ï¼Œé»˜è®¤ä¸º `True`ï¼‰ã€‚åœ¨æ–¹æ³•å†…éƒ¨ï¼Œåˆ›å»ºä¸€ä¸ª `OBBModel` å®ä¾‹ï¼Œå¹¶æ ¹æ®æä¾›çš„æƒé‡æ–‡ä»¶åŠ è½½æ¨¡å‹æƒé‡ã€‚

`get_validator` æ–¹æ³•è¿”å›ä¸€ä¸ª `OBBValidator` å®ä¾‹ï¼Œç”¨äºéªŒè¯ YOLO æ¨¡å‹çš„æ€§èƒ½ã€‚åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œå®šä¹‰äº†æŸå¤±åç§°ï¼ŒåŒ…æ‹¬ "box_loss"ã€"cls_loss" å’Œ "dfl_loss"ï¼Œå¹¶åˆ›å»ºä¸€ä¸ª `OBBValidator` å¯¹è±¡ï¼Œä¼ å…¥æµ‹è¯•æ•°æ®åŠ è½½å™¨ã€ä¿å­˜ç›®å½•å’Œå‚æ•°çš„å‰¯æœ¬ã€‚

æ•´ä¸ªç±»çš„è®¾è®¡æ—¨åœ¨ä¸º OBB æ¨¡å‹çš„è®­ç»ƒæä¾›ä¸€ä¸ªæ¸…æ™°çš„æ¥å£å’Œç»“æ„ï¼Œä½¿å¾—ç”¨æˆ·èƒ½å¤Ÿæ–¹ä¾¿åœ°è¿›è¡Œæ¨¡å‹è®­ç»ƒå’ŒéªŒè¯ã€‚ç¤ºä¾‹ä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `OBBTrainer` ç±»è¿›è¡Œè®­ç»ƒï¼Œç”¨æˆ·åªéœ€æä¾›æ¨¡å‹è·¯å¾„ã€æ•°æ®é…ç½®æ–‡ä»¶å’Œè®­ç»ƒè½®æ•°å³å¯å¼€å§‹è®­ç»ƒã€‚

#### 11.6 train.py

ä»¥ä¸‹æ˜¯ä»£ç ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œå¹¶é™„ä¸Šè¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šï¼š

```python
import os
import torch
import yaml
from ultralytics import YOLO  # å¯¼å…¥YOLOæ¨¡å‹åº“
from QtFusion.path import abs_path  # å¯¼å…¥è·¯å¾„å¤„ç†å‡½æ•°

# è®¾ç½®è®¾å¤‡ä¸ºGPUï¼ˆå¦‚æœå¯ç”¨ï¼‰ï¼Œå¦åˆ™ä½¿ç”¨CPU
device = "0" if torch.cuda.is_available() else "cpu"

if __name__ == '__main__':  # ç¡®ä¿è¯¥æ¨¡å—è¢«ç›´æ¥è¿è¡Œæ—¶æ‰æ‰§è¡Œä»¥ä¸‹ä»£ç 
    workers = 1  # è®¾ç½®æ•°æ®åŠ è½½çš„å·¥ä½œè¿›ç¨‹æ•°
    batch = 2    # è®¾ç½®æ¯ä¸ªæ‰¹æ¬¡çš„å¤§å°

    data_name = "data"  # æ•°æ®é›†åç§°
    # è·å–æ•°æ®é›†yamlæ–‡ä»¶çš„ç»å¯¹è·¯å¾„
    data_path = abs_path(f'datasets/{data_name}/{data_name}.yaml', path_type='current')  
    unix_style_path = data_path.replace(os.sep, '/')  # å°†è·¯å¾„è½¬æ¢ä¸ºUnixé£æ ¼

    # è·å–æ•°æ®é›†ç›®å½•è·¯å¾„
    directory_path = os.path.dirname(unix_style_path)
    
    # è¯»å–YAMLæ–‡ä»¶ï¼Œä¿æŒåŸæœ‰é¡ºåº
    with open(data_path, 'r') as file:
        data = yaml.load(file, Loader=yaml.FullLoader)
    
    # ä¿®æ”¹YAMLæ–‡ä»¶ä¸­çš„è·¯å¾„é¡¹
    if 'path' in data:
        data['path'] = directory_path  # æ›´æ–°è·¯å¾„ä¸ºæ•°æ®é›†ç›®å½•
        # å°†ä¿®æ”¹åçš„æ•°æ®å†™å›YAMLæ–‡ä»¶
        with open(data_path, 'w') as file:
            yaml.safe_dump(data, file, sort_keys=False)

    # åŠ è½½é¢„è®­ç»ƒçš„YOLOv8æ¨¡å‹
    model = YOLO(model='./ultralytics/cfg/models/v8/yolov8s.yaml', task='detect')  
    
    # å¼€å§‹è®­ç»ƒæ¨¡å‹
    results2 = model.train(
        data=data_path,  # æŒ‡å®šè®­ç»ƒæ•°æ®çš„é…ç½®æ–‡ä»¶è·¯å¾„
        device=device,  # æŒ‡å®šä½¿ç”¨çš„è®¾å¤‡ï¼ˆGPUæˆ–CPUï¼‰
        workers=workers,  # æŒ‡å®šæ•°æ®åŠ è½½çš„å·¥ä½œè¿›ç¨‹æ•°
        imgsz=640,  # æŒ‡å®šè¾“å…¥å›¾åƒçš„å¤§å°ä¸º640x640
        epochs=100,  # æŒ‡å®šè®­ç»ƒ100ä¸ªepoch
        batch=batch,  # æŒ‡å®šæ¯ä¸ªæ‰¹æ¬¡çš„å¤§å°
        name='train_v8_' + data_name  # æŒ‡å®šè®­ç»ƒä»»åŠ¡çš„åç§°
    )
```

### ä»£ç æ ¸å¿ƒéƒ¨åˆ†è¯´æ˜ï¼š
1. **è®¾å¤‡é€‰æ‹©**ï¼šæ ¹æ®æ˜¯å¦æœ‰å¯ç”¨çš„GPUï¼Œé€‰æ‹©è®­ç»ƒè®¾å¤‡ä¸ºGPUæˆ–CPUã€‚
2. **æ•°æ®é›†è·¯å¾„å¤„ç†**ï¼šé€šè¿‡`abs_path`å‡½æ•°è·å–æ•°æ®é›†çš„ç»å¯¹è·¯å¾„ï¼Œå¹¶å°†è·¯å¾„æ ¼å¼è½¬æ¢ä¸ºUnixé£æ ¼ã€‚
3. **YAMLæ–‡ä»¶è¯»å–ä¸ä¿®æ”¹**ï¼šè¯»å–YAMLæ–‡ä»¶ä¸­çš„æ•°æ®ï¼Œæ›´æ–°å…¶ä¸­çš„è·¯å¾„é¡¹ï¼Œå¹¶å°†ä¿®æ”¹åçš„å†…å®¹å†™å›æ–‡ä»¶ã€‚
4. **æ¨¡å‹åŠ è½½ä¸è®­ç»ƒ**ï¼šåŠ è½½YOLOv8æ¨¡å‹ï¼Œå¹¶å¼€å§‹è®­ç»ƒï¼ŒæŒ‡å®šè®­ç»ƒå‚æ•°å¦‚æ•°æ®è·¯å¾„ã€è®¾å¤‡ã€å·¥ä½œè¿›ç¨‹æ•°ã€å›¾åƒå¤§å°ã€è®­ç»ƒè½®æ•°å’Œæ‰¹æ¬¡å¤§å°ã€‚

è¿™ä¸ªç¨‹åºæ–‡ä»¶`train.py`çš„ä¸»è¦åŠŸèƒ½æ˜¯ä½¿ç”¨YOLOv8æ¨¡å‹è¿›è¡Œç›®æ ‡æ£€æµ‹çš„è®­ç»ƒã€‚é¦–å…ˆï¼Œç¨‹åºå¯¼å…¥äº†å¿…è¦çš„åº“ï¼ŒåŒ…æ‹¬`os`ã€`torch`ã€`yaml`å’Œ`ultralytics`ä¸­çš„YOLOæ¨¡å‹ã€‚æ ¹æ®ç³»ç»Ÿæ˜¯å¦æ”¯æŒCUDAï¼Œç¨‹åºä¼šé€‰æ‹©ä½¿ç”¨GPUï¼ˆè®¾å¤‡"0"ï¼‰è¿˜æ˜¯CPUï¼ˆè®¾å¤‡"cpu"ï¼‰è¿›è¡Œè®­ç»ƒã€‚

åœ¨`__main__`å—ä¸­ï¼Œç¨‹åºé¦–å…ˆå®šä¹‰äº†ä¸€äº›è®­ç»ƒå‚æ•°ï¼Œå¦‚å·¥ä½œè¿›ç¨‹æ•°`workers`å’Œæ‰¹æ¬¡å¤§å°`batch`ã€‚æ¥ç€ï¼Œç¨‹åºæŒ‡å®šäº†æ•°æ®é›†çš„åç§°`data_name`ï¼Œå¹¶æ„å»ºäº†æ•°æ®é›†é…ç½®æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚è¿™é‡Œçš„æ•°æ®é›†é…ç½®æ–‡ä»¶æ˜¯ä¸€ä¸ªYAMLæ–‡ä»¶ï¼ŒåŒ…å«äº†è®­ç»ƒæ‰€éœ€çš„æ•°æ®è·¯å¾„å’Œå…¶ä»–ç›¸å…³ä¿¡æ¯ã€‚

ç¨‹åºä½¿ç”¨`yaml`åº“è¯»å–è¯¥YAMLæ–‡ä»¶ï¼Œå¹¶å°†å…¶ä¸­çš„`path`é¡¹ä¿®æ”¹ä¸ºæ•°æ®é›†æ‰€åœ¨çš„ç›®å½•è·¯å¾„ï¼Œä»¥ç¡®ä¿åç»­çš„è®­ç»ƒè¿‡ç¨‹èƒ½å¤Ÿæ­£ç¡®æ‰¾åˆ°æ•°æ®ã€‚ä¿®æ”¹åçš„å†…å®¹ä¼šè¢«å†™å›åˆ°YAMLæ–‡ä»¶ä¸­ã€‚

éšåï¼Œç¨‹åºåŠ è½½äº†YOLOv8æ¨¡å‹çš„é…ç½®æ–‡ä»¶ï¼Œå¹¶å‡†å¤‡å¼€å§‹è®­ç»ƒã€‚`model.train`æ–¹æ³•è¢«è°ƒç”¨ï¼Œä¼ å…¥äº†å¤šä¸ªå‚æ•°ï¼ŒåŒ…æ‹¬æ•°æ®é…ç½®æ–‡ä»¶çš„è·¯å¾„ã€è®¾å¤‡ç±»å‹ã€å·¥ä½œè¿›ç¨‹æ•°ã€è¾“å…¥å›¾åƒçš„å¤§å°ï¼ˆ640x640ï¼‰ã€è®­ç»ƒçš„è½®æ•°ï¼ˆ100ä¸ªepochï¼‰ã€æ‰¹æ¬¡å¤§å°ï¼Œä»¥åŠè®­ç»ƒä»»åŠ¡çš„åç§°ã€‚è¿™æ ·ï¼Œç¨‹åºå°±ä¼šå¼€å§‹åœ¨æŒ‡å®šçš„æ•°æ®é›†ä¸Šè¿›è¡ŒYOLOv8æ¨¡å‹çš„è®­ç»ƒã€‚

æ•´ä½“æ¥çœ‹ï¼Œè¿™æ®µä»£ç å®ç°äº†ä»æ•°æ®å‡†å¤‡åˆ°æ¨¡å‹è®­ç»ƒçš„å®Œæ•´æµç¨‹ï¼Œé€‚åˆç”¨äºç›®æ ‡æ£€æµ‹ä»»åŠ¡çš„æ·±åº¦å­¦ä¹ è®­ç»ƒã€‚

### 12.ç³»ç»Ÿæ•´ä½“ç»“æ„ï¼ˆèŠ‚é€‰ï¼‰

### æ•´ä½“åŠŸèƒ½å’Œæ„æ¶æ¦‚æ‹¬

è¯¥é¡¹ç›®ä¸»è¦å›´ç»•ç›®æ ‡æ£€æµ‹å’Œå›¾åƒå¤„ç†å±•å¼€ï¼Œåˆ©ç”¨Ultralytics YOLOæ¡†æ¶å’Œå…¶ä»–ç›¸å…³æ¨¡å—ï¼Œæä¾›äº†ä¸€æ•´å¥—ç”¨äºè®­ç»ƒã€é¢„æµ‹å’Œå¯è§†åŒ–çš„å·¥å…·ã€‚é¡¹ç›®çš„æ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬ï¼š

1. **æ¨¡å‹è®­ç»ƒ**ï¼šæ”¯æŒYOLOv8æ¨¡å‹çš„è®­ç»ƒï¼Œèƒ½å¤Ÿå¤„ç†ä¸åŒç±»å‹çš„æ•°æ®é›†ï¼ˆå¦‚æ ‡å‡†è¾¹ç•Œæ¡†å’Œå®šå‘è¾¹ç•Œæ¡†ï¼‰ã€‚
2. **å›¾åƒåˆ†ç±»ä¸æ£€æµ‹**ï¼šå®ç°äº†å›¾åƒåˆ†ç±»çš„é¢„æµ‹åŠŸèƒ½ï¼Œèƒ½å¤Ÿå¯¹è¾“å…¥å›¾åƒè¿›è¡Œåˆ†ç±»å¹¶è¿”å›ç»“æœã€‚
3. **å›¾åƒåˆ†å‰²ä¸æ³¨é‡Š**ï¼šæä¾›äº†åŸºäºæç¤ºçš„å›¾åƒåˆ†å‰²åŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡è¾¹ç•Œæ¡†ã€ç‚¹å’Œæ–‡æœ¬è¿›è¡Œäº¤äº’å¼çš„å›¾åƒæ³¨é‡Šã€‚
4. **ç”¨æˆ·ç•Œé¢**ï¼šé€šè¿‡å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰æä¾›äº†å¯¹æ•°æ®é›†çš„å¯è§†åŒ–å’Œç®¡ç†ï¼Œä¾¿äºç”¨æˆ·è¿›è¡Œæ•°æ®æ¢ç´¢å’Œåˆ†æã€‚
5. **å®ç”¨å·¥å…·**ï¼šåŒ…å«ä¸€äº›è¾…åŠ©å·¥å…·å’Œæ¨¡å—ï¼Œæ”¯æŒæ•°æ®å¤„ç†ã€å¯è§†åŒ–å’Œæ¨¡å‹è¯„ä¼°ç­‰åŠŸèƒ½ã€‚

### æ–‡ä»¶åŠŸèƒ½æ•´ç†è¡¨

| æ–‡ä»¶è·¯å¾„                                      | åŠŸèƒ½æè¿°                                                       |
|-------------------------------------------|------------------------------------------------------------|
| `ultralytics/solutions/ai_gym.py`       | å®ç°å®æ—¶è§†é¢‘æµä¸­çš„å¥èº«åŠ¨ä½œè®¡æ•°ï¼ŒåŸºäºäººä½“å§¿æ€è¿›è¡ŒåŠ¨ä½œæ£€æµ‹ã€‚                  |
| `ui.py`                                  | æä¾›ä¸€ä¸ªæ¥å£ï¼Œé€šè¿‡å‘½ä»¤è¡Œå¯åŠ¨ä¸€ä¸ªåŸºäºStreamlitçš„Webåº”ç”¨ã€‚                   |
| `ultralytics/models/yolo/classify/predict.py` | å®ç°å›¾åƒåˆ†ç±»çš„é¢„æµ‹æµç¨‹ï¼ŒåŒ…æ‹¬å›¾åƒé¢„å¤„ç†ã€æ¨¡å‹é¢„æµ‹å’Œç»“æœåå¤„ç†ã€‚             |
| `ultralytics/models/fastsam/prompt.py`  | æä¾›å›¾åƒæ³¨é‡Šå’Œåˆ†å‰²åŠŸèƒ½ï¼Œæ”¯æŒç”¨æˆ·é€šè¿‡ä¸åŒæ–¹å¼ï¼ˆè¾¹ç•Œæ¡†ã€ç‚¹ã€æ–‡æœ¬ï¼‰è¿›è¡Œäº¤äº’ã€‚  |
| `ultralytics/models/yolo/obb/train.py`   | å®šä¹‰OBBTrainerç±»ï¼Œç”¨äºåŸºäºå®šå‘è¾¹ç•Œæ¡†æ¨¡å‹è¿›è¡Œè®­ç»ƒã€‚                        |
| `train.py`                               | å¯åŠ¨YOLOv8æ¨¡å‹çš„è®­ç»ƒæµç¨‹ï¼Œé…ç½®æ•°æ®é›†å’Œè®­ç»ƒå‚æ•°ã€‚                          |
| `ultralytics/solutions/__init__.py`     | åˆå§‹åŒ–è§£å†³æ–¹æ¡ˆæ¨¡å—ï¼Œå¯èƒ½åŒ…å«æ¨¡å—çš„å¯¼å…¥å’ŒåŸºæœ¬é…ç½®ã€‚                          |
| `ultralytics/models/sam/modules/decoders.py` | å®ç°åˆ†å‰²æ¨¡å‹çš„è§£ç å™¨åŠŸèƒ½ï¼Œå¤„ç†æ¨¡å‹è¾“å‡ºå¹¶ç”Ÿæˆåˆ†å‰²ç»“æœã€‚                     |
| `ultralytics/data/explorer/gui/dash.py` | æä¾›æ•°æ®é›†çš„å¯è§†åŒ–å’Œç®¡ç†ç•Œé¢ï¼Œä¾¿äºç”¨æˆ·è¿›è¡Œæ•°æ®æ¢ç´¢ã€‚                        |
| `ultralytics/data/explorer/utils.py`     | åŒ…å«æ•°æ®å¤„ç†å’Œæ¢ç´¢çš„å®ç”¨å·¥å…·å‡½æ•°ï¼Œæ”¯æŒæ•°æ®é›†çš„åŠ è½½å’Œé¢„å¤„ç†ã€‚                |

è¿™ä¸ªè¡¨æ ¼æ€»ç»“äº†é¡¹ç›®ä¸­å„ä¸ªæ–‡ä»¶çš„ä¸»è¦åŠŸèƒ½ï¼Œå±•ç¤ºäº†å®ƒä»¬åœ¨æ•´ä½“æ¶æ„ä¸­çš„ä½œç”¨ã€‚

æ³¨æ„ï¼šç”±äºæ­¤åšå®¢ç¼–è¾‘è¾ƒæ—©ï¼Œä¸Šé¢â€œ11.é¡¹ç›®æ ¸å¿ƒæºç è®²è§£ï¼ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçœ‹ä¸æ‡‚ä»£ç é€»è¾‘ï¼‰â€ä¸­éƒ¨åˆ†ä»£ç å¯èƒ½ä¼šä¼˜åŒ–å‡çº§ï¼Œä»…ä¾›å‚è€ƒå­¦ä¹ ï¼Œå®Œæ•´â€œè®­ç»ƒæºç â€ã€â€œWebå‰ç«¯ç•Œé¢â€å’Œâ€œ70+ç§åˆ›æ–°ç‚¹æºç â€ä»¥â€œ13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–â€çš„å†…å®¹ä¸ºå‡†ã€‚

### 13.å®Œæ•´è®­ç»ƒ+Webå‰ç«¯ç•Œé¢+70+ç§åˆ›æ–°ç‚¹æºç ã€æ•°æ®é›†è·å–

![19.png](19.png)

https://mbd.pub/o/bread/ZpqYm59q